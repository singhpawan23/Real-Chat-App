if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSSerializeBackupPayloadIndirection.bs",["bs_curry","cr:280","cr:740","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){if(b("cr:740")==null)if(b("cr:280")==null)return b("unrecoverableViolation")("LSSerializeBackupPayloadIndirection.res: messenger_armadillo_web:enable_armadillo OR messenger_armadillo_web:enable_encrypted_backups_shadow_test is not defined","labyrinth_web");else return b("bs_curry")._5(b("cr:280").call,a,c,d,e,f).then(function(a){return a});else return b("bs_curry")._5(b("cr:740").call,a,c,d,e,f).then(function(a){return a})}f.$LSSerializeBackupPayloadConditional$requireCond=b("cr:280");f.$LSSerializeBackupPayloadConditional$requireCond$1=b("cr:740");f.call=a}),null);
__d("LSSyncEpochs",["LSAppendDataTraceAddon","LSCreateDataTraceID.bs","LSDeleteBackupOnClient","LSFlushDataTrace.bs","LSIssueNewTask"],(function(a,b,c,d,e,f){function g(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);g=function(){return a};return a}function a(){var a=arguments,c=a[a.length-1],d=c.n,e=[],f=[],h;return c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Beginning execution."),c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?e[0]=!1:(a.item,e[0]=!0)})},function(a){return e[0]?e[2]=c.i64.or_([0,78],[0,128]):e[2]=[0,78],c.nop(b("LSCreateDataTraceID.bs")).then(function(a){return a=a,e[3]=a[0],a})},function(a){return e[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",e[4],"EncryptedBackups Trace ID",e[4],c.i64.to_string(e[2])].join("")),c.db.table(153).add({traceId:e[3],initTimestampMs:c.i64.of_float(Date.now()),traceType:e[2],shouldFlush:!1,contextThree:"synch_epochs"})},function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,1436],[0,2],h,h):c.resolve()},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.context===c.i64.to_string([0,50013])}).next().then(function(a,b){b=a.done;a=a.value;return b?e[5]=!1:(a.item,e[5]=!0)})},function(a){return e[5]?c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Another sync job is already in progress. Terminating this."),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Another sync job is already in progress. Terminating this.",h):c.resolve():c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.bs"),e[3]):c.resolve()}]):c.seq([function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[7]=a})},function(a){return c.i64.eq(e[7],[0,1])?c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(a,f){var i=a.done;a=a.value;return i?0:(f=a.item,e[9]=f.backupId,e[8]=f.deviceId,c.i64.neq(e[8],h)?c.seq([function(a){return c.ct(c.db.table(169).fetch()).then(function(a){return e[10]=a})},function(a){return c.i64.neq(e[10],d(g()))?e[11]=!0:e[11]=!1,e[11]?(e[12]=new c.Map(),e[12].set("backup_id",e[9]),e[12].set("device_id",e[8]),e[12].set("trace_id",e[3]),e[13]=c.toJSON(e[12]),c.sp(b("LSIssueNewTask"),"messenger_encrypted_backups",[0,50013],e[13],h,h,[0,0],[0,0],h,h,[0,0])):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client"),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client",h):c.resolve():c.resolve()},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[9],"synch_epochs",!0,e[3])}])}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client"),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client",h):c.resolve():c.resolve()},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[9],"synch_epochs",!0,e[3])}]))}):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Exactly 1 entry is expected in client_state_table"),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Exactly 1 entry is expected in client_state_table",h):c.resolve():c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.bs"),e[3]):c.resolve()},function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[8]=a})},function(a){return e[9]="",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]",e[9],"Exactly 1 entry is expected in client_state_table. Found = ",e[9],c.i64.to_string(e[8])].join(""))}])}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(f)}])}e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerMuteThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(a){return c[6]=f.threadKey,b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?(c[7]=b.createArray(),c[8]=(c[7].push("TaskSerializerMuteThreadV2: Thread not found"),c[7]),c[9]=(c[7].push(c[6]),c[7]),c[10]=b.toJSON(c[7]),function(a){b.logger(a).mustfix(a)}(c[10]),a=[e,e],c[3]=a[0],c[4]=a[1],a):(f=d.item,b.seq([function(a){return b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[7]=[0,1]:(f=d.item,c[12]=f.syncGroup,b.i64.neq(c[12],e)?c[11]=c[12]:c[11]=[0,1],c[7]=c[11])})},function(a){return c[9]=new b.Map(),c[9].set("thread_key",c[6]),c[9].set("mailbox_type",[0,0]),c[9].set("mute_expire_time_ms",f.muteExpireTimeMs),c[9].set("sync_group",c[7]),c[10]=b.toJSON(c[9]),a=[c[10],[0,144]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,c[5]=f.removeType,b.i64.neq(c[5],e)?(c[6]=new b.Map(),c[6].set("thread_key",f.threadKey),c[6].set("remove_type",c[5]),c[6].set("sync_group",f.syncGroup==null?[0,1]:f.syncGroup),c[7]=b.toJSON(c[6]),g=[c[7],[0,146]],c[3]=g[0],c[4]=g[1],g):(d=[e,e],c[3]=d[0],c[4]=d[1],d),f=[c[3],c[4]],c[0]=f[0],c[1]=f[1],f)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(d){return c[9]=f.offlineThreadingId,c[10]=f.messageId,c[14]=f.threadAttributionSource,c[7]=f.platformRef,c[8]=f.platformToken,c[6]=f.replySourceId,c[11]=f.replySourceType,c[13]=f.sendType,c[12]=f.initiatingSource,b.db.table(12).fetch([[[c[9]]],"optimistic"]).next().then(function(f,h){var d=f.done;f=f.value;return d?(c[15]=b.createArray(),c[16]=(c[15].push("OTID not found"),c[15]),c[17]=(c[15].push(c[9]),c[15]),c[18]=b.toJSON(c[15]),function(a){b.logger(a).mustfix(a)}(c[18]),d=[e,e],c[3]=d[0],c[4]=d[1],d):(h=f.item,b.seq([function(d){return c[21]=h.text,c[19]=h.threadKey,c[22]=h.messageId,c[20]=h.stickerId,c[24]=h.mentionOffsets,c[25]=h.mentionLengths,c[18]=h.mentionIds,c[26]=h.mentionTypes,c[29]=h.replyType,c[27]=h.isForwarded,c[23]=h.forwardScore,c[28]=h.hotEmojiSize,b.db.table(9).fetch([[[c[19]]]]).next().then(function(f,i){var d=f.done;f=f.value;return d?(c[30]=b.createArray(),c[31]=(c[30].push("thread not found"),c[30]),c[32]=(c[30].push(c[19]),c[30]),c[33]=b.toJSON(c[30]),function(a){b.logger(a).mustfix(a)}(c[33]),d=[e,e],c[15]=d[0],c[16]=d[1],d):(i=f.item,b.seq([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var d=e.done;e=e.value;return d?c[30]=!1:(f=e.item,b.seq([function(d){return b.islc(b.ftr(b.db.table(2).fetch(),function(a){return a.queueName===f.queueName}),0,b.i64.to_float([0,1])).next().then(function(e,f){var d=e.done;e=e.value;return d?c[34]=!1:(f=e.item,c[34]=b.i64.eq(f.taskId,a[0]))})},function(a){return c[30]=c[34]}]))})},function(a){return b.i64.eq(i.authorityLevel,[0,20])&&b.i64.eq(i.threadType,[0,2])&&c[30]?b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?b.i64.neq(c[44],e)?(c[34].set("url",c[43]),c[34].set("attribution_app_id",c[44]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[43]=e:(d=b.item,c[43]=d.attachmentFbid)})},function(a){return c[43]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[43]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?(c[34].set("url",c[43]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[39]=c[6]===""?e:c[6],c[39]!==e?b.i64.neq(c[11],e)?(c[43]=new b.Map(),c[43].set("reply_source_id",c[39]),c[43].set("reply_source_type",c[11]),c[43].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[43])):0:0,c[40]=c[18]===""?e:c[18],c[40]!==e?(c[43]=c[24]===""?e:c[24],c[43]!==e?(c[44]=c[25]===""?e:c[25],c[44]!==e?(c[45]=new b.Map(),c[45].set("mention_ids",c[40]),c[45].set("mention_offsets",c[43]),c[45].set("mention_lengths",c[44]),c[45].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[45])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[41]=c[7]===""?e:c[7],c[41]!==e?c[34].set("platform_ref",c[41]):0,c[42]=c[8]===""?e:c[8],c[42]!==e?c[34].set("platform_token",c[42]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.createArray(),b.fe(b.db.table(14).fetch([[[c[19]]]]),function(a){a=a.item;return c[43]=(c[36].push(a.contactId),c[36])})},function(a){return c[37]=new b.Map(),c[37].set("participants",c[36]),c[37].set("send_payload",c[34]),b.fe(b.ftr(b.db.table(9).fetch(),function(a){return b.i64.eq(a.threadKey,i.threadKey)}),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:h.offlineThreadingId})})},function(a){return c[38]=b.toJSON(c[37]),a=[c[38],[0,130]],c[32]=a[0],c[33]=a[1],a}]):b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?b.i64.neq(c[42],e)?(c[34].set("url",c[41]),c[34].set("attribution_app_id",c[42]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[41]=e:(d=b.item,c[41]=d.attachmentFbid)})},function(a){return c[41]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[41]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?(c[34].set("url",c[41]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[37]=c[6]===""?e:c[6],c[37]!==e?b.i64.neq(c[11],e)?(c[41]=new b.Map(),c[41].set("reply_source_id",c[37]),c[41].set("reply_source_type",c[11]),c[41].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[41])):0:0,c[38]=c[18]===""?e:c[18],c[38]!==e?(c[41]=c[24]===""?e:c[24],c[41]!==e?(c[42]=c[25]===""?e:c[25],c[42]!==e?(c[43]=new b.Map(),c[43].set("mention_ids",c[38]),c[43].set("mention_offsets",c[41]),c[43].set("mention_lengths",c[42]),c[43].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[43])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[39]=c[7]===""?e:c[7],c[39]!==e?c[34].set("platform_ref",c[39]):0,c[40]=c[8]===""?e:c[8],c[40]!==e?c[34].set("platform_token",c[40]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.toJSON(c[34]),a=[c[36],[0,46]],c[32]=a[0],c[33]=a[1],a}])},function(a){return a=[c[32],c[33]],c[15]=a[0],c[16]=a[1],a}]))})},function(a){return a=[c[15],c[16]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasksForQueue",["LSAppendDataTraceAddon","LSFlushDataTrace.bs","LSSerializeBackupPayloadIndirection.bs","LSSyncEpochs","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","gkx","qex"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return c.ftr(c.db.table(3).fetch([[[a[0]]]]),function(b){return c.i64.neq(b.epochId,f)&&b.taskQueueName===a[0]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[0]=!1:(a.item,d[0]=!0)})},function(e){return d[2]=new c.Map(),d[2].set("queue_name",a[0]),d[2].set("next_sync_ms",f),d[2].set("work_item_type",[0,4]),d[2].set("network_payload",f),d[2].set("http_url_override",f),d[2].set("skip_realtime_gateway",!1),d[3]=d[2],d[0]?c.resolve():c.seq([function(b){return c.islc(c.ftr(c.db.table(2).fetch(),function(b){return b.queueName===a[0]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c)})},function(b){return c.db.table(3).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[11]=[0,0]:(b=a.item,d[11]=b.lastSyncRequestTimestampMs)})},function(e){return d[14]=c.i64.sub(d[5],c.i64.of_float(Date.now())),c.i64.le(d[14],[0,0])?(c.i64.eq(d[7],[0,0])||a[1]?d[15]=[0,0]:(c.i64.gt(d[7],[0,7])?d[17]=c.i64.sub(d[7],[0,7]):d[17]=d[7],d[18]=c.i64.sub(d[17],[0,1]),d[19]=c.i64.mul(c.i64.lsl_([0,1],c.i64.to_int32(c.i64.lt(d[18],[0,7])?d[18]:[0,7])),[0,500]),d[15]=c.i64.lt(d[19],[0,3e4])?d[19]:[0,3e4]),d[16]=c.i64.sub(c.i64.add(d[11],d[15]),c.i64.of_float(Date.now())),d[13]=c.i64.gt(d[16],[0,0])?d[16]:[0,0]):d[13]=d[14],c.i64.neq(d[13],[0,0])?c.resolve((d[15]=new c.Map(),d[15].set("queue_name",a[0]),d[15].set("next_sync_ms",d[13]),d[15].set("work_item_type",[0,3]),d[15].set("network_payload",f),d[15].set("http_url_override",f),d[15].set("skip_realtime_gateway",!1),d[3]=d[15])):c.seq([function(a){return c.i64.neq(d[6],[0,0])||d[8]==="16"||d[8]==="4"?c.resolve((a=[d[4],f,[0,2],f,f,!1],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a)):c.seq([function(a){return d[22]=c.createArray(),d[23]=!0,c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c)})},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[31]=!0:(a.item,d[31]=!0)})},function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),function(a){var e=a.item;return d[42]=e.taskId,d[40]=e.context,d[43]=e.failureCount,d[41]=e.timeoutTimestampMs,d[23]=e.httpUrlOverride===d[29]&&!0===d[31]&&d[23],d[23]?c.seq([function(a){return d[40]===f?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[44]=f}]):c.seq([function(a){return c.i64.neq(d[41],f)?d[49]=c.i64.ge(c.i64.of_float(Date.now()),d[41]):d[49]=!1,d[49]?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[50]=f}]):c.seq([function(a){return c.seq([function(a){return d[40]==="46"?c.seq([function(a){return c.sp(b("LSTaskSerializerSendMessageV2"),d[42]).then(function(a){return a=a,d[58]=a[0],d[59]=a[1],a})},function(a){return a=[d[58],c.i64.to_string(d[59])],d[54]=a[0],d[55]=a[1],a}]):c.seq([function(a){return d[40]==="144"?c.seq([function(a){return c.sp(b("LSTaskSerializerMuteThreadV2"),d[42]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],a})},function(a){return a=[d[60],c.i64.to_string(d[61])],d[58]=a[0],d[59]=a[1],a}]):c.seq([function(a){return d[40]==="146"?c.seq([function(a){return c.sp(b("LSTaskSerializerRemoveThread"),d[42]).then(function(a){return a=a,d[62]=a[0],d[63]=a[1],a})},function(a){return a=[d[62],c.i64.to_string(d[63])],d[60]=a[0],d[61]=a[1],a}]):c.seq([function(a){return d[40]==="32"?c.seq([function(a){return c.seq([function(a){return c.db.table(32).fetch([[[d[42]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[69]=c.createArray(),d[70]=(d[69].push("taskSerializerUpdateThreadName: Task ID not found"),d[69]),d[71]=(d[69].push(d[42]),d[69]),d[72]=c.toJSON(d[69]),function(a){c.logger(a).mustfix(a)}(d[72]),e=[f,f],d[66]=e[0],d[67]=e[1],e):(b=a.item,c.seq([function(a){return d[72]=b.threadKey,c.db.table(9).fetch([[[d[72]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[73]=c.createArray(),d[74]=(d[73].push("taskSerializerUpdateThreadName: Thread not found"),d[73]),d[75]=(d[73].push(d[72]),d[73]),d[76]=c.toJSON(d[73]),function(a){c.logger(a).mustfix(a)}(d[76]),a=[f,f],d[69]=a[0],d[70]=a[1],a):(e=b.item,c.seq([function(a){return c.db.table(9).fetch([[[d[72]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[73]=[0,1]:(e=b.item,d[78]=e.syncGroup,c.i64.neq(d[78],f)?d[77]=d[78]:d[77]=[0,1],d[73]=d[77])})},function(a){return d[75]=new c.Map(),d[75].set("thread_key",d[72]),d[75].set("thread_name",e.threadName==null?"":e.threadName),d[75].set("sync_group",d[73]),d[76]=c.toJSON(d[75]),a=[d[76],[0,32]],d[69]=a[0],d[70]=a[1],a}]))})},function(a){return a=[d[69],d[70]],d[66]=a[0],d[67]=a[1],a}]))})},function(a){return a=[d[66],d[67]],d[64]=a[0],d[65]=a[1],a}])},function(a){return a=[d[64],c.i64.to_string(d[65])],d[62]=a[0],d[63]=a[1],a}]):c.seq([function(a){return d[40]==="362"?c.resolve((a=[f,f],d[66]=a[0],d[67]=a[1],a,a=[d[66],c.i64.to_string(d[67])],d[64]=a[0],d[65]=a[1],a)):c.seq([function(a){return d[40]==="50015"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Beginning execution."),c.db.table(168).fetch().next().then(function(a,e){var h=a.done;a=a.value;return h?(h=[f,f],d[70]=h[0],d[71]=h[1],h):(e=a.item,c.seq([function(a){return d[75]=e.deviceId,c.i64.neq(d[75],f)?c.seq([function(a){return c.db.table(190).fetch([[[d[42]]]]).next().then(function(e,i){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]No restore payload context found."),a=[f,f],d[76]=a[0],d[77]=a[1],a):(i=e.item,c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Beginning execution."),c.ct(c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[83]=a})},function(a){return c.i64.le(d[83],[0,1])?c.seq([function(a){return c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[88]=function(a){return a==f?f:a}(b("qex")._("2159")),d[88]!==f?d[87]=d[88]:d[87]=!1,d[87]===!1?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[85]=f}]):(i=e.item,d[87]=new c.Map(),d[87].set("epoch_id",i.epochId),d[87].set("epoch_root_key",i.epochRootKeyBlob),d[87].set("epoch_anon_id",i.epochAnonIdBlob),d[85]=d[87])})},function(a){return d[84]=d[85]}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSecureEncryptedBackupsEpochsTable]Error! More than 1 open epoch was found. Calling the sync flow and returning empty results"),c.sp(b("LSSyncEpochs"))},function(a){return c.ftr(c.db.table(169).fetch(),function(a){return!1}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[88]=function(a){return a==f?f:a}(b("qex")._("2159")),d[88]!==f?d[87]=d[88]:d[87]=!1,d[87]===!1?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[85]=f}]):(i=e.item,d[87]=new c.Map(),d[87].set("epoch_id",i.epochId),d[87].set("epoch_root_key",i.epochRootKeyBlob),d[87].set("epoch_anon_id",i.epochAnonIdBlob),d[85]=d[87])})},function(a){return d[84]=d[85]}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Finishing execution."),d[79]=d[84]}])},function(a){return d[79]!==f?(d[83]=d[79].get("epoch_id"),d[79],d[80]=d[83]):d[80]=f,d[81]=new c.Map(),d[81].set("content_type",i.contentType),d[81].set("device_id",d[75]),d[81].set("epoch_id",d[80]),d[81].set("list_id",i.listId),d[81].set("num_items",i.numItems),d[81].set("start_sort_key",i.startSortKey),d[81].set("mailbox_partial_id",i.mailboxPartialId),d[81].set("trace_id",i.traceId),d[82]=c.toJSON(d[81]),a=[d[82],[0,50015]],d[76]=a[0],d[77]=a[1],a}]))})},function(a){return a=[d[76],d[77]],d[73]=a[0],d[74]=a[1],a}]):c.resolve((function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Unexpected error: Device ID is null."),a=[f,f],d[73]=a[0],d[74]=a[1],a))},function(a){return a=[d[73],d[74]],d[70]=a[0],d[71]=a[1],a}]))})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Finishing execution."),a=[d[70],d[71]],d[68]=a[0],d[69]=a[1],a}])},function(a){return a=[d[68],c.i64.to_string(d[69])],d[66]=a[0],d[67]=a[1],a}]):c.seq([function(a){return d[40]==="319"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Beginning execution."),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,e){var h=a.done;a=a.value;return h?c.seq([function(a){return c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Task not found."),d[77]=f):(e=b.item,d[77]=e.dataTraceId)})},function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Pending backup context not found"),d[77]!==f?d[77]!==f?c.sp(b("LSAppendDataTraceAddon"),d[77],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Pending backup context not found",f):c.resolve():c.resolve()},function(a){return d[77]!==f?c.nop(b("LSFlushDataTrace.bs"),d[77]):c.resolve()},function(a){return d[72]=f}]):(e=a.item,d[72]=e.lsTraceId)})},function(a){return d[72]!==f?c.sp(b("LSAppendDataTraceAddon"),d[72],[0,1451],[0,2],f,f):c.resolve()},function(a){return d[72]!==f?0:function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Trace ID is null"),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[74]=f:(b=a.item,d[74]=b.echoContent)})},function(a){return c.nop(b("LSSerializeBackupPayloadIndirection.bs"),d[42],d[74],d[72]).then(function(a){return a=a,d[76]=a[0],a})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Finishing execution."),a=[d[76],[0,319]],d[70]=a[0],d[71]=a[1],a}])},function(a){return a=[d[70],c.i64.to_string(d[71])],d[68]=a[0],d[69]=a[1],a}]):c.resolve((a=[e.taskValue,d[40]],d[68]=a[0],d[69]=a[1],a))},function(a){return a=[d[68],d[69]],d[66]=a[0],d[67]=a[1],a}])},function(a){return a=[d[66],d[67]],d[64]=a[0],d[65]=a[1],a}])},function(a){return a=[d[64],d[65]],d[62]=a[0],d[63]=a[1],a}])},function(a){return a=[d[62],d[63]],d[60]=a[0],d[61]=a[1],a}])},function(a){return a=[d[60],d[61]],d[58]=a[0],d[59]=a[1],a}])},function(a){return a=[d[58],d[59]],d[54]=a[0],d[55]=a[1],a}])},function(a){return d[31]?(a=[d[54],d[55]],d[56]=a[0],d[57]=a[1],a):(a=[f,f],d[58]=a[0],d[59]=a[1],a,a=[d[58],c.i64.to_string(d[59])],d[56]=a[0],d[57]=a[1],a),a=[d[56],d[57]],d[51]=a[0],d[52]=a[1],a}])},function(a){return d[51]!==f?(d[54]=new c.Map(),d[54].set("label",d[52]),d[54].set("payload",d[51]),d[54].set("queue_name",e.queueName),d[54].set("task_id",d[42]),d[54].set("failure_count",c.i64.eq(d[43],[0,0])?f:d[43]),d[53]=d[54]):d[53]=f,d[50]=d[53]}])},function(a){return d[44]=d[50]}])},function(a){return d[44]?d[45]=!1:d[45]=!0,d[45]?0:d[49]=(d[22].push(d[44]),d[22]),d[46]=c.i64.of_int32(d[22].length),b("gkx")("6280")?d[47]=[0,50]:d[47]=[0,5],d[40]!==f?d[48]=["90","130","153"].includes(d[40]):d[48]=!1,d[23]=!(c.i64.ge(d[46],d[47])||d[48])}]):c.resolve()})},function(a){return d[33]=c.i64.of_int32(d[22].length),c.i64.eq(d[33],[0,0])?c.resolve((a=[d[4],f,[0,4],f,f,!1],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a)):c.seq([function(a){return d[40]=c.i64.random(),d[50]=c.i64.and_(c.i64.or_(c.i64.lsl_(c.i64.of_float(Date.now()),c.i64.to_int32([0,22])),c.i64.and_(d[40],[0,4194303])),[2147483647,4294967295]),c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?c.db.table(3).add({syncDatabaseId:[-1,4294967295],taskQueueName:d[4],failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:c.i64.of_float(Date.now()),epochId:d[50]}):(a.item,c.fe(c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:d[50],lastSyncRequestTimestampMs:c.i64.of_float(Date.now())})}))})},function(a){return c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c)})},function(a){return d[49]=new c.Map(),d[49].set("tasks",d[22]),d[49].set("epoch_id",d[50]),a=[d[4],f,[0,1],d[49],d[47],!(d[47]===f)||c.i64.gt(d[45],[0,7])],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a}])},function(a){return a=[d[34],d[35],d[36],d[37],d[38],d[39]],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a}])},function(a){return d[21]=new c.Map(),d[21].set("queue_name",d[15]),d[21].set("next_sync_ms",d[16]),d[21].set("work_item_type",d[17]),d[21].set("network_payload",d[18]),d[21].set("http_url_override",d[19]),d[21].set("skip_realtime_gateway",d[20]),d[3]=d[21]}])}])},function(a){return e[0]=d[3]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasks",["LSBeginHandlingPendingTasksForQueue"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return d[0]=c.createArray(),c.gb(c.sb(c.db.table(2).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(e){return c.seq([function(f){return c.sp(b("LSBeginHandlingPendingTasksForQueue"),e.queueName,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return c.gb(c.sb(c.db.table(5).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(a){return d[1]=a.queueName,c.seq([function(a){return d[2]=c.createArray(),c.fe(c.ftr(c.db.table(5).fetch(),function(a){return a.queueName===d[1]}),function(a){a=a.item;return d[5]=new c.Map(),d[5].set("label",a.context),d[5].set("payload",a.taskValue),d[5].set("queue_name",a.queueName),d[5].set("task_id",a.taskId),d[5].set("failure_count",c.i64.eq([0,0],[0,0])?f:[0,0]),d[6]=(d[2].push(d[5]),d[2])})},function(a){return d[3]=new c.Map(),d[3].set("tasks",d[2]),d[3].set("epoch_id",f),d[4]=new c.Map(),d[4].set("queue_name",d[1]),d[4].set("next_sync_ms",f),d[4].set("work_item_type",[0,5]),d[4].set("network_payload",d[3]),d[4].set("http_url_override",f),d[4].set("skip_realtime_gateway",!1),d[5]=(d[0].push(d[4]),d[0])}])})},function(a){return c.fe(c.db.table(5).fetch(),function(a){return a["delete"]()})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var f=a.done;a=a.value;return f?c[0]=e:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],e,[0,4],e,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.seq([function(a){return c[9]=c[0].get("group_id"),c[0],b.ftr(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,e)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),c[0],d=[c[17],e,[0,4],e,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4],d)):b.seq([function(d){return c[27]=b.i64.of_float(Date.now()),c[17]=c[0].get("min_time_to_sync_timestamp_ms"),c[0],c[18]=c[0].get("last_sync_request_timestamp_ms"),c[0],c[19]=c[0].get("can_ignore_timestamp"),c[0],c[19]&&a[1]||b.i64.ge(c[27],c[17])?b.seq([function(d){return a[1]?b.resolve(c[28]=[0,0]):b.seq([function(a){return c[29]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[30]=[0,0]:(b=a.item,c[30]=b.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_([0,1],b.i64.to_int32(b.i64.lt([0,15],c[30])?[0,15]:c[30])),[0,1]),[0,500]),c[33]=b.i64.sub(b.i64.add(c[18]==null?[0,0]:c[18],b.i64.lt(c[32],[0,3e4])?c[32]:[0,3e4]),c[27]),c[28]=b.i64.gt(c[33],[0,0])?c[33]:[0,0]}])},function(a){return c[20]=c[28]}]):b.resolve(c[20]=b.i64.sub(c[17],c[27]))},function(a){return c[21]=c[0].get("group_id"),c[0],b.i64.gt(c[20],[0,0])?b.seq([function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastDelayedRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return a=[c[21],c[20],[0,3],e,!1],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}]):b.seq([function(a){return b.fe(b.db.table(1).fetch([[[c[21]]]]),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return c[28]=c[0].get("group_id"),c[0],c[29]=b.i64.random(),c[42]=b.i64.and_(b.i64.or_(b.i64.lsl_(b.i64.of_float(Date.now()),b.i64.to_int32([0,22])),b.i64.and_(c[29],[0,4194303])),[2147483647,4294967295]),b.db.table(3).fetch([[["",c[28]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[28],taskQueueName:"",failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:[0,0],epochId:c[42]}):(a.item,b.fe(b.db.table(3).fetch([[["",c[28]]]]),function(a){var b=a.update;a.item;return b({epochId:c[42]})}))})},function(a){return c[31]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[31]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[32]=[0,0]:(b=a.item,c[32]=b.failureCount)})},function(a){return c[34]=c[0].get("send_sync_params"),c[0],c[35]=c[0].get("sync_params"),c[0],c[36]=c[0].get("current_cursor"),c[0],c[37]=new b.Map(),c[37].set("database",c[31]),c[37].set("version",[-1,4294967295]),c[37].set("epoch_id",c[42]),c[37].set("last_applied_cursor",c[36]),c[37].set("sync_params",c[34]?c[35]:e),c[37].set("failure_count",b.i64.gt(c[32],[0,0])?c[32]:e),c[38]=c[0].get("current_cursor"),c[0],e===c[38]?c[39]=[0,1]:c[39]=[0,2],c[40]=new b.Map(),c[40].set("type",c[39]),c[40].set("request_payload",c[37]),c[41]=c[0].get("sync_channel"),c[0],a=[c[28],e,[0,1],c[40],b.i64.eq(c[41],[0,2])],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}])},function(a){return a=[c[22],c[23],c[24],c[25],c[26]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(f){return c.seq([function(e){return d[0]=c.createArray(),c.fe(c.db.table(1).fetch(),function(e){var f=e.item;return c.seq([function(e){return c.sp(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSHandleTaskSendSuccessForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d;return b.seq([function(c){return b.fe(b.ftr(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(c){return c.taskQueueName===a[0]&&b.i64.eq(c.syncDatabaseId,[-1,4294967295])&&!b.i64.eq(c.epochId,d)}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSUpdateCommunityChannelDirectInvite",["LSIssueNewError","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(a){return c.sb(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=!1:(b=a.item,d[0]=b.errorShouldBeShown)})},function(a){return d[0]===!0?(d[11]=c.localizeV2([0,2285622730],f),d[12]=c.localizeV2([0,1919524925],f),c.sp(b("LSIssueNewError"),f,[0,1545093],d[11],d[12])):c.resolve()},function(e){return d[2]=new c.Map(),d[2].set("channel_id",a[0]),d[2].set("state",a[1]),c.i64.gt([0,0],[0,0])?d[3]=c.i64.add(c.i64.of_float(Date.now()),[0,0]):d[3]=[0,0],d[4]=d[2].get("channel_id"),d[2],d[5]=c.toJSON(d[2]),c.sp(b("LSIssueNewTaskAndGetTaskID"),["community_channel_invitation","_",c.i64.to_string(d[4])].join(""),[0,463],d[5],f,f,[0,0],[0,0],f,f,d[3]).then(function(a){return a=a,d[6]=a[0],a})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[7]=[-1,4294967295]:(b=a.item,d[7]=b.parentThreadKey)})},function(a){return c.db.table(162).fetch([[[d[7]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[9]=[-1,4294967295]:(b=a.item,d[9]=b.fbGroupId)})},function(b){return c.i64.eq(a[1],[0,1])?c.fe(c.ftr(c.db.table(162).fetch(),function(a){return c.i64.eq(a.fbGroupId,d[9])}),function(a){var b=a.update;a.item;return b({joiningChannelTaskId:d[6]})}):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSClearTables",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(a){return b.seq([function(a){return b.fe(b.db.table(67).fetch(),function(a){return a["delete"]()})},function(a){return b.fe(b.db.table(66).fetch(),function(a){return a["delete"]()})},function(a){return b.fe(b.db.table(65).fetch(),function(a){return a["delete"]()})},function(a){return b.fe(b.db.table(69).fetch(),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSInsertRankingContacts",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("limit",a[0]),d[1]=c.createArray(),d[4]=(d[1].push("search_contacts"),d[1]),d[4]=(d[1].push(c.i64.to_string(c.i64.of_float(Date.now()))),d[1]),d[2]=c.toJSON(d[1]),d[3]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),d[2],[0,452],d[3],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSIssueSearchQuery",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.db.table(67).fetch([[[a[0]]]]).next().then(function(e,g){g=e.done;e=e.value;return g?c.seq([function(b){return c.db.table(67).add({query:a[0],statusPrimary:[0,1],statusSecondary:[0,1],startTimeMs:c.i64.of_float(Date.now())})},function(e){return d[1]=new c.Map(),d[1].set("query",a[0]),d[1].set("supported_types",a[1]),d[1].set("session_id",a[2]),d[1].set("surface_type",a[3]),d[1].set("group_id",a[4]),d[1].set("thread_id",a[5]),d[2]=c.createArray(),d[7]=(d[2].push("search_primary"),d[2]),d[7]=(d[2].push(c.i64.to_string(c.i64.of_float(Date.now()))),d[2]),d[3]=c.toJSON(d[2]),d[4]=c.toJSON(d[1]),c.sp(b("LSIssueNewTask"),d[3],[0,30],d[4],f,f,[0,0],[0,0],f,f,[0,0])},function(e){return d[5]=new c.Map(),d[5].set("query",a[0]),d[5].set("supported_types",a[1]),d[5].set("session_id",a[2]),d[5].set("surface_type",a[3]),d[5].set("group_id",a[4]),d[5].set("thread_id",a[5]),d[6]=c.toJSON(d[5]),c.sp(b("LSIssueNewTask"),"search_secondary",[0,31],d[6],f,f,[0,0],[0,0],f,f,[0,0])}]):(e.item,0)})},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("GroupsCometJoinChatDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8014260225254541"}),null);
__d("GroupsCometJoinChatDialogQuery$Parameters",["GroupsCometJoinChatDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("GroupsCometJoinChatDialogQuery_facebookRelayOperation"),metadata:{},name:"GroupsCometJoinChatDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("GroupsCometJoinChatDialog.entrypoint",["GroupsCometJoinChatDialogQuery$Parameters","JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){var b=a.groupID;a=a.threadID;return{queries:{myQueryReference:{parameters:c("GroupsCometJoinChatDialogQuery$Parameters"),variables:{groupID:b,threadID:a}}}}},root:c("JSResourceForInteraction")("GroupsCometJoinChatDialog.react").__setRef("GroupsCometJoinChatDialog.entrypoint")};g["default"]=a}),98);
__d("MWUseAriaLabelForThread.bs",["fbt","MWPActor.bs","MWPGetThreadTitle.bs","ReQL.bs","ReQLSuspense","bs_belt_Option","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||b("react");function a(a){var c=b("MWPActor.bs").useActor(void 0),d=b("useReStore")(),e=b("ReQLSuspense").useArray(function(){var c;return(c=b("ReQL.bs")).take(c.leftJoin(c.getKeyRange(c.fromTableAscending(d.table("participants")),{hd:a.threadKey,tl:0}),c.fromTableAscending(d.table("contacts"))),8)},[a.threadKey]);return i.useMemo(function(){var d=a.threadName;if(d!==void 0)return g._(/*FBT_CALL*/"\u092c\u093e\u0924\u091a\u0940\u0924 \u0915\u093e \u091f\u093e\u0907\u091f\u0932 {name of conversation}"/*FBT_CALL*/,[g._param("name of conversation",d)]).toString();d=b("bs_belt_Option").getWithDefault(b("MWPGetThreadTitle.bs").computeThreadTitle(void 0,a,e,c),"");return g._(/*FBT_CALL*/"{participant list} \u0915\u0947 \u0938\u093e\u0925 \u092c\u093e\u0924\u091a\u0940\u0924"/*FBT_CALL*/,[g._param("participant list",d)]).toString()},[a.threadName,c])}f.useHook=a}),null);
__d("MessageRequestsBulkActionsThreadListItem.bs",["ix","CometPressable.react","JSSet.bs","MWPIsThreadUnread.bs","MWUseAriaLabelForThread.bs","MessageRequestsBulkActionsContext.react","TetraIcon.react","bs_curry","bs_int64","fbicon","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react"),k={pressableContent:{borderTopStartRadius:"ue3kfks5",borderTopEndRadius:"pw54ja7n",borderBottomEndRadius:"uo3d90p7",borderBottomStartRadius:"l82x9zwi",display:"a8c37x1j",width:"k4urcfbm"},selectorWrapper:{display:"j83agx80",alignItems:"bp9cbjyn",paddingTop:"jb3vyjys",paddingEnd:"rv4hoivh",paddingBottom:"qt6c0cv9",paddingStart:"h4z51re5"},checkboxWrapper:{paddingRight:"l6okmz22"},threadItemContainerEditMode:{pointerEvents:"hzruof5a",flexGrow:"buofh1pr",minWidth:"hpfvmrgz"}};function a(a){var c=a.thread;a=a.threadListCell;var d=j.useContext(b("MessageRequestsBulkActionsContext.react")),e=d.setBulkActionsUnreadSelectedThreads,f=d.setBulkActionsSelectedThreads,h=d.bulkActionsSelectedThreads,l=b("bs_int64").to_string(c.threadKey),m=j.useCallback(function(a){return b("bs_curry")._1(f,function(a){a=new Set(b("JSSet.bs").values(a));if(a["delete"](l))return a;else return a.add(l)})});j.useEffect(function(){b("bs_curry")._1(e,function(a){a=new Set(b("JSSet.bs").values(a));if(b("MWPIsThreadUnread.bs").isThreadUnread(c)&&h.has(l))return a.add(l);else if(b("MWPIsThreadUnread.bs").isThreadUnread(c)){a["delete"](l);return a}else return a})},[h]);d=h.has(l);var n=b("MWUseAriaLabelForThread.bs").useHook(c);return j.jsx(b("CometPressable.react"),{"aria-label":n,role:"checkbox",onPress:function(a){return b("bs_curry")._1(m,void 0)},xstyle:function(a){return[k.pressableContent]},children:j.jsxs("div",{"aria-hidden":!0,className:(i||(i=b("stylex")))(k.selectorWrapper),children:[j.jsx("div",{className:i(k.checkboxWrapper),children:j.jsx(b("TetraIcon.react"),{icon:d?b("fbicon")._(g("484757"),20):b("fbicon")._(g("659288"),20),color:d?"highlight":"disabled",hideHoverOverlay:!0})}),j.jsx("div",{className:i(k.threadItemContainerEditMode),children:a})]}),"aria-checked":d})}c=a;f.styles=k;f.make=c}),null);
__d("MAWUnsupportedIndexedDBNuxKey",["WebStorage"],(function(a,b,c,d,e,f,g){"use strict";var h="maw_unsupported_browser_nux_dismissed",i="dismissed";a=function(){var a;return((a=c("WebStorage").getLocalStorageForRead())==null?void 0:a.getItem(h))===i};b=function(){var a;(a=c("WebStorage").getLocalStorage())==null?void 0:a.setItem(h,i)};g.getIsDismissed=a;g.setIsDismissed=b}),98);
__d("MWJewelThreadAddOnSecondaryIcons",["cr:1737009"],(function(a,b,c,d,e,f,g){"use strict";g.MWJewelThreadAddOnSecondaryIcons=b("cr:1737009")}),98);
__d("MWJewelThreadSnippet.react",["CurrentEnvironment","MDSText.react","TetraText.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.isUnread;a=a.text;return b?c("CurrentEnvironment").facebookdotcom?h.jsx(c("TetraText.react"),{color:"highlight",numberOfLines:1,type:"bodyLink4",children:a}):c("MDSText.react")!=null?h.jsx(c("MDSText.react"),{color:"primary",numberOfLines:1,type:"entityHeaderMeta3",children:a}):h.jsx(c("TetraText.react"),{color:"primary",numberOfLines:1,type:"bodyLink4",children:a}):h.jsx(c("TetraText.react"),{color:"secondary",numberOfLines:1,type:"body4",children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWLSJewelHasReachedEnd.bs",["ReQL.bs","ReQLSubscription.bs","bs_belt_Option","bs_curry","cr:10862","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=b("cr:10862")==null?function(a){return!1}:b("cr:10862").useHook;function a(a){var c=b("useReStore")(),d=b("bs_belt_Option").mapWithDefault(b("ReQLSubscription.bs").useFirst(h.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("threads_ranges_v2__generated")),{hd:a,tl:0})},[c,JSON.stringify(a)])),!1,function(a){return!a.hasMoreBefore}),e=!b("bs_curry")._1(i,a);if(d)return e;else return!1}c=b("cr:10862");f.$MAWHasMoreSecureThreads$requireCond=b("cr:10862");f.mawHasMoreThreads=c;f.useHasMoreSecureThreads=i;f.useHook=a}),null);
__d("MWLSJewelLoadMoreThreads.bs",["LS.bs","LSThreadsRangesQuery","LSTransaction.bs","LsSystemFolder.bs","Promise","ReQL.bs","bs_caml","bs_caml_int64","bs_curry","bs_int64","cr:2881","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function i(a,c){return b("LSThreadsRangesQuery")(c,!0,!1,(c=b("bs_int64")).max_int,c.max_int,c.max_int,c.max_int,b("bs_caml_int64").zero,b("LS.bs").make(a))}function j(a,c){var d=b("cr:2881")==null?b("Promise").resolve(void 0):b("bs_curry")._2(b("cr:2881").loadMoreSecureThreads,a,c),e=b("ReQL.bs").first(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("threads_ranges_v2__generated")),function(a){return b("bs_caml").i64_eq(a.parentThreadKey,c)})).then(function(d){if(d!==void 0)if(!d.isLoadingBefore&&d.hasMoreBefore)return b("LSThreadsRangesQuery")(c,!0,!1,d.minThreadKey,d.maxThreadKey,d.maxLastActivityTimestampMs,d.minLastActivityTimestampMs,b("bs_caml_int64").zero,b("LS.bs").make(a));else return b("Promise").resolve(void 0);else return i(a,c)});return b("Promise").all([d,e])}function a(a){var c=b("useReStore")();return h.useMemo(function(){return function(){var d=b("LSTransaction.bs").run(c,function(b){return j(b,a)},"readWrite");b("promiseDone")(d,void 0,void 0)}},[c,JSON.stringify(a)])}function k(a,c){var d=b("cr:2881")==null?b("Promise").resolve(void 0):b("bs_curry")._2(b("cr:2881").loadMoreSecureThreads,a,c),e=b("ReQL.bs").first(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("threads_ranges_v2__generated")),function(a){return b("bs_caml").i64_eq(a.parentThreadKey,c)})).then(function(d){if(d!==void 0)if(d.isLoadingBefore)return b("Promise").resolve(void 0);else return b("LSThreadsRangesQuery")(c,!1,!0,void 0,d.minThreadKey,d.minLastActivityTimestampMs,void 0,b("bs_caml_int64").zero,b("LS.bs").make(a));else return i(a,c)});return b("Promise").all([d,e])}function c(a){var c=b("useReStore")();return h.useMemo(function(){return function(a){a=b("LSTransaction.bs").run(c,function(a){return k(a,b("LsSystemFolder.bs").other)},"readWrite");b("promiseDone")(a,void 0,void 0)}},[c])}d=b("cr:2881");f.$MAWLoadMoreSecureThreads$requireCondXplat=b("cr:2881");f.mawLoadMoreSecureThreads=d;f.loadMoreThreads=j;f.useHook=a;f.loadSpamThreads=k;f.useLoadSpamThreads=c}),null);
__d("MWJewelMessageRequestsThread.react",["fbt","ix","I64","Locale","LsSystemFolderInterop.re","MWJewelThreadSnippet.react","ReQL","ReQLSuspense","TetraIcon.react","TetraListCell.react","fbicon","react","useReStore"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k=function(){var a=c("useReStore")();return d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(a.table("threads").index("parentThreadKeyLastActivityTimestampMs")).getKeyRange(d("LsSystemFolderInterop.re").pending).filter(function(a){return d("I64").i64_gt(a.lastActivityTimestampMs,a.lastReadWatermarkTimestampMs)}).map(function(b){b=b.snippetSenderContactId;if(b!=null){b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(b));return b?b.name:void 0}})},[a])};function a(a){var b=a.onOpenMessageRequests;a=a.unreadRequestsCount;var e=h._(/*FBT_CALL*/{"*":"\u0928\u0908 \u092e\u0948\u0938\u0947\u091c \u0930\u093f\u0915\u094d\u0935\u0947\u0938\u094d\u091f","_1":"\u0928\u092f\u093e \u0938\u0902\u0926\u0947\u0936 \u0905\u0928\u0941\u0930\u094b\u0927"}/*FBT_CALL*/,[h._plural(a)]),f=h._(/*FBT_CALL*/{"someone":"\u0910\u0938\u0947 \u0915\u093f\u0938\u0940 \u0935\u094d\u092f\u0915\u094d\u0924\u093f \u0938\u0947 \u091c\u093f\u0938\u0947 \u0906\u092a \u0936\u093e\u092f\u0926 \u091c\u093e\u0928\u0924\u0947 \u0939\u0948\u0902","people":"\u0926\u094b\u0938\u094d\u0924 \u092c\u0928\u093e\u0928\u0947 \u0915\u0947 \u0938\u0941\u091d\u093e\u0935\u094b\u0902 \u0938\u0947"}/*FBT_CALL*/,[h._enum(a===1?"someone":"people",{someone:"someone",people:"people"})]),g=k();g!=null&&(a===1?f=h._(/*FBT_CALL*/"{name} \u0915\u0940 \u0913\u0930 \u0938\u0947"/*FBT_CALL*/,[h._param("name",g)]):f=h._(/*FBT_CALL*/"{name} \u0914\u0930 {count} \u0905\u0928\u094d\u092f \u0915\u0940 \u0913\u0930 \u0938\u0947"/*FBT_CALL*/,[h._param("name",g),h._param("count",a-1)]));return j.jsx(c("TetraListCell.react"),{addOnPrimary:{icon:d("fbicon")._(i("542884"),24),size:56,type:"contained-icon"},addOnSecondary:{addOn:j.jsx(c("TetraIcon.react"),{color:"secondary",icon:d("Locale").isRTL()?d("fbicon")._(i("492485"),16):d("fbicon")._(i("492533"),16)}),type:"body"},body:j.jsx(c("MWJewelThreadSnippet.react"),{isUnread:!0,text:f}),headline:e,level:4,onPress:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWLSLoadThreadFolderIfNotPresent.bs",["CancellablePromise.bs","CancellationToken.bs","MWLSJewelLoadMoreThreads.bs","Promise","ReQL.bs","bs_caml","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")(),d=b("MWLSJewelLoadMoreThreads.bs").useHook(a);h.useEffect(function(){var e=b("CancellationToken.bs").make(void 0),f=b("CancellablePromise.bs").ignoreFailed(void 0,b("CancellablePromise.bs").then_(e,function(a){a!==void 0||d();return b("Promise").resolve(void 0)},b("ReQL.bs").first(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(c.table("threads_ranges_v2__generated")),function(c){return b("bs_caml").i64_eq(c.parentThreadKey,a)}))));b("promiseDone")(f,void 0,void 0);return e.cancel},[d,c,JSON.stringify(a)])}f.useHook=a}),null);
__d("MWLSJewelMessageRequestsThread.bs",["LsSystemFolder.bs","MWJewelMessageRequestsThread.react","MWLSLoadThreadFolderIfNotPresent.bs","MWPActor.bs","ReQL.bs","ReQLSubscription.bs","bs_caml","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=b("MWJewelMessageRequestsThread.react");c={make:i};function j(a){var c=b("useReStore")();a=b("MWPActor.bs").useActor(void 0);a=h.useMemo(function(){return b("ReQL.bs").filter(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexDescending(c.table("threads").index("parentThreadKeyLastActivityTimestampMs")),{hd:b("LsSystemFolder.bs").pending,tl:0}),function(a){return b("bs_caml").i64_gt(a.lastActivityTimestampMs,a.lastReadWatermarkTimestampMs)})},[c,JSON.stringify(a)]);return b("ReQLSubscription.bs").useArray(a).length}function a(a){b("MWLSLoadThreadFolderIfNotPresent.bs").useHook(b("LsSystemFolder.bs").pending);var c=j(void 0);if(a!==void 0&&c>0)return h.jsx(i,{onOpenMessageRequests:a,unreadRequestsCount:c});else return null}f.RequestsThread=c;f.useHook=a}),null);
__d("MWLSJewelThreadSeenByImages.bs",["LSMediaUrl.bs","MWPActor.bs","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_belt_Option","bs_caml","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")(),d=b("MWPActor.bs").useActor(void 0);return b("ReQLSubscription.bs").useArray(h.useMemo(function(){var e;return(e=b("ReQL.bs")).map(e.take(e.filter(e.bounds(e.getKeyRange(e.fromIndexAscending(c.table("participants").index("threadKeyReadWatermarkTimestampMs")),{hd:a.threadKey,tl:0}),{NAME:"greaterThanOrEqual",VAL:{hd:a.lastActivityTimestampMs,tl:0}}),function(a){return b("bs_caml").i64_neq(a.contactId,d)}),3),function(a){return b("bs_belt_Option").map(b("ReQLSuspense").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("contacts")),{hd:a.contactId,tl:0})),function(a){return{alt:a.name,src:b("LSMediaUrl.bs").Contact.profilePictureUrl(a)}})})},[c,JSON.stringify(a.threadKey),JSON.stringify(d),JSON.stringify(a.lastActivityTimestampMs)])).reduce(function(a,b){if(b!==void 0)return a.concat([b]);else return a},[])}f.useHook=a}),null);
__d("TetraMWJewelThreadAddOnSecondaryIcons",["ix","TetraIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("react");b=a.jsx(c("TetraIcon.react"),{color:"disabled",icon:d("fbicon")._(h("569284"),16)});g.bell=b}),98);
__d("mwGroupEntriesForDisplay",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=new Map();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e,f,g;if(c){if(d>=a.length)break;g=a[d++]}else{d=a.next();if(d.done)break;g=d.value}g=g;e=(e=g.rawData.section)!=null?e:"";f=(f=b.get(e))!=null?f:[];f.push(g);b.set(e,f)}return b}f.mwGroupEntriesForDisplay=a}),66);
__d("MWChatSearchLightspeedTypeaheadViewList.react",["TetraText.react","getItemRoleFromCompositeRole","mwGroupEntriesForDisplay","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useMemo;function j(a){var b=a.activeEntryKey,d=a.children,e=a.entries,f=a.itemRole;a=a.title;return e!=null&&e.length>0?h.jsxs("li",{className:"scb9dxdr qt6c0cv9 dflh9lhu jb3vyjys",children:[a?h.jsx("div",{className:"scb9dxdr sj5x9vvc dflh9lhu cxgpxx05",children:h.jsx(c("TetraText.react"),{type:"entityHeaderMeta1",children:a})}):null,h.jsx("ul",{children:e.map(function(a,c){var e=b===a.key;return d({entry:a,index:c,isActive:e,itemRole:f})})})]}):null}function a(a){var b=a.ariaProps,e=a.children,f=a.entries,g=a.highlightedEntry;a=babelHelpers.objectWithoutPropertiesLoose(a,["ariaProps","children","entries","highlightedEntry"]);var k=g!=null?g.key:null;a=i(function(){return d("mwGroupEntriesForDisplay").mwGroupEntriesForDisplay(f)},[f]);var l=c("getItemRoleFromCompositeRole")(b.role);return h.jsx("ul",{"data-testid":void 0,role:"listbox",children:Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];return h.jsx(j,{activeEntryKey:k,children:e,entries:a,itemRole:l,title:b},b)})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelLightspeedSearchTypeaheadViewList.react",["CometScrollView.react","MWChatSearchLightspeedTypeaheadViewList.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={scroll:{maxHeight:"nt8syekh"}};function a(a){var b=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["xstyle"]);return h.jsx(c("CometScrollView.react"),{showsHorizontalScrollIndicator:!1,xstyle:[i.scroll,b],children:h.jsx(c("MWChatSearchLightspeedTypeaheadViewList.react"),babelHelpers["extends"]({},a))})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelSearchEmptyState.react",["fbt","TetraText.react","react","useCometTypeaheadEmptyState"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){var b=c("useCometTypeaheadEmptyState")();return b?i.jsxs("div",{className:"tw6a2znq f10w8fjw d1544ag0 pybr56ya",children:[i.jsx(c("TetraText.react"),{align:"center",type:"body2",children:h._(/*FBT_CALL*/"\u0915\u0941\u091b \u0928\u0939\u0940\u0902 \u092e\u093f\u0932\u093e"/*FBT_CALL*/)}),i.jsx("br",{}),i.jsx(c("TetraText.react"),{align:"center",color:"tertiary",type:"body3",children:h._(/*FBT_CALL*/"\u0939\u092e\u0947\u0902 \"{query}\" \u0915\u0947 \u0932\u093f\u090f \u0915\u094b\u0908 \u092e\u093f\u0932\u093e\u0928 \u0928\u0939\u0940\u0902 \u092e\u093f\u0932\u093e. \u091f\u093e\u0907\u092a\u093f\u0902\u0917 \u0915\u0940 \u0917\u0932\u0924\u093f\u092f\u093e\u0901 \u0938\u0941\u0927\u093e\u0930\u0947\u0902 \u0914\u0930 \u092a\u0942\u0930\u0947 \u0936\u092c\u094d\u0926 \u0932\u093f\u0916\u0947\u0902."/*FBT_CALL*/,[h._param("query",a.queryString)])})]}):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelSearchTypeaheadHelper.bs",["bs_caml_int64","bs_int64"],(function(a,b,c,d,e,f){"use strict";function a(a){return{resultIndex:b("bs_int64").to_string(a.globalIndex),resultType:b("bs_caml_int64").to_int32(a.type_),threadType:b("bs_caml_int64").to_int32(a.threadType),queryString:a.query,resultFbid:a.resultId}}f.getLoggingValues=a}),null);
__d("MWJewelSearchTypeaheadHelper.re",["MWJewelSearchTypeaheadHelper.bs"],(function(a,b,c,d,e,f){a=b("MWJewelSearchTypeaheadHelper.bs").getLoggingValues;f.getLoggingValues=a}),null);
__d("MDSLockSvgIcon.re",["MDSLockSvgIcon.bs"],(function(a,b,c,d,e,f){a=b("MDSLockSvgIcon.bs").make;f.make=a}),null);
__d("MWJewelSearchTypeaheadViewItem.react",["fbt","ix","CometIcon.react","CometMiddot.react","CometPageVerificationIcon.react","CometTextWithIcon.react","CometTypeaheadViewItem.react","CurrentEnvironment","MDSLockSvgIcon.re","MWChatFacepile.re","MWChatProfile.re","TetraText.react","TetraTextPairing.react","XCometMessengerControllerRouteBuilder","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.entry;a.queryString;a=babelHelpers.objectWithoutPropertiesLoose(a,["entry","queryString"]);var e=b.rawData,f=e.id,g=e.imageUrl,k=e.isE2e,l=e.isInstagramAccount,m=e.isInteropEligible,n=e.resultType,o=e.secondaryImageUrl,p=e.section,q=e.subtext;e=e.verificationStatus;q=k?h._(/*FBT_CALL*/"\u090f\u0902\u0921-\u091f\u0942-\u090f\u0902\u0921 \u090f\u0928\u094d\u0915\u094d\u0930\u093f\u092a\u094d\u091f\u0947\u0921"/*FBT_CALL*/):q;n=n==="messages"?j.jsx("div",{className:"qnrpqo6b ae35evdt jxrgncrl fdg1wqfs",children:j.jsx(c("CometIcon.react"),{color:"primary",icon:d("fbicon")._(i("491284"),24),size:24})}):o!==""?j.jsx(d("MWChatFacepile.re").make,{firstParticipantURI:g,secondParticipantURI:o,size:36}):j.jsx(d("MWChatProfile.re").make,{size:36,src:g});o=c("CurrentEnvironment").facebookdotcom?c("XCometMessengerControllerRouteBuilder").buildURL({thread_key:f}):"/t/"+f+"/";return j.jsx(c("CometTypeaheadViewItem.react"),babelHelpers["extends"]({},a,{entry:b,isDisabled:l===!0&&m===!1,itemStartContent:n,linkProps:{preventLocalNavigation:!0,url:o},testid:void 0,children:j.jsx(c("TetraTextPairing.react"),{body:j.jsxs(c("TetraText.react"),{numberOfLines:1,type:"body3",children:[b.label,e!=null?j.jsx("span",{className:"scb9dxdr",children:j.jsx(c("CometPageVerificationIcon.react"),{size:"small",verificationBadge:e})}):null]}),level:3,meta:q&&q!==""?j.jsx(c("TetraText.react"),{numberOfLines:1,type:"meta4",children:j.jsxs(c("CometTextWithIcon.react"),{iconBefore:k?j.jsx(d("MDSLockSvgIcon.re").make,{color:"black",size:"12"}):null,children:[q,(p==null||p==="")&&Boolean(b.rawData.isInstagramAccount)?j.jsxs(j.Fragment,{children:[j.jsx(c("CometMiddot.react"),{}),"Instagram"]}):null]})}):null})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("createMWJewelSearchTypeaheadViewStrategy.react",["CometTypeaheadProgressGlimmer.react","MWJewelLightspeedSearchTypeaheadViewList.react","MWJewelSearchEmptyState.react","MWJewelSearchTypeaheadViewItem.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return function(b){var d=b.ariaProps,e=b.entries;b.extraViewProps;var f=b.highlightedEntry,g=b.isLoading;b.onAbandonTypeahead_DO_NOT_USE;var i=babelHelpers.objectWithoutPropertiesLoose(b,["ariaProps","entries","extraViewProps","highlightedEntry","isLoading","onAbandonTypeahead_DO_NOT_USE"]);b=e.length===0&&i.queryString.length>0;g=e.length>0&&g;return b?h.jsx(c("MWJewelSearchEmptyState.react"),{queryString:i.queryString}):h.jsxs(h.Fragment,{children:[h.jsx(c("MWJewelLightspeedSearchTypeaheadViewList.react"),{ariaProps:d,entries:e,highlightedEntry:f,xstyle:a,children:function(a){var b=a.entry,d=a.isActive;a=a.itemRole;return h.createElement(c("MWJewelSearchTypeaheadViewItem.react"),babelHelpers["extends"]({},i,{entry:b,isActive:d,key:b.key,role:a}))}}),g&&h.jsx(c("CometTypeaheadProgressGlimmer.react"),{})]})}}g["default"]=a}),98);
__d("MWLSParticipant.bs",["LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactType.bs","LSContactWorkForeignEntityType.bs","LSMailboxType.bs","LSMediaUrl.bs","MWLSContactTypeExactUtils.bs","ReQL.bs","bs_belt_Option","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";e={contact_id:(d=b("bs_caml_int64")).zero,thread_key:d.zero,contactType:b("LSContactType.bs").unknown,mailbox_type:b("LSMailboxType.bs").messenger,read_watermark_timestamp_ms:d.zero,read_action_timestamp_ms:d.zero,delivered_watermark_timestamp_ms:d.zero,name:"",actual_name:"",secondary_name:void 0,nickname:void 0,blocked_by_viewer_status:b("LSContactBlockedByViewerStatus.bs").unblocked,profile_picture_url:"",is_messenger_user:!1,is_admin:!1,gender:b("LSContactGender.bs").unknown,rank:0,work_company_name:void 0,work_job_title:void 0,work_foreign_entity_info:b("LSContactWorkForeignEntityType.bs").unknown};function g(a){var c=a[1];a=a[0];var d=a.nickname;if(d!==void 0)d=d;else{var e=c.firstName;d=e!==void 0?e:c.name}return{contact_id:a.contactId,thread_key:a.threadKey,contactType:c.contactType,mailbox_type:b("LSMailboxType.bs").messenger,read_watermark_timestamp_ms:a.readWatermarkTimestampMs,read_action_timestamp_ms:a.readActionTimestampMs,delivered_watermark_timestamp_ms:a.deliveredWatermarkTimestampMs,name:d,actual_name:c.name,secondary_name:b("MWLSContactTypeExactUtils.bs").isIgContact(c)?c.secondaryName:void 0,nickname:a.nickname,blocked_by_viewer_status:c.blockedByViewerStatus,profile_picture_url:b("LSMediaUrl.bs").Contact.profilePictureUrl(c),is_messenger_user:c.isMessengerUser,is_admin:b("bs_belt_Option").getWithDefault(a.isAdmin,!1),gender:c.gender,rank:c.rank,work_company_name:c.workCompanyName,work_job_title:c.workJobTitle,work_foreign_entity_info:c.workForeignEntityType}}function a(a,c,d){var e;return(e=b("ReQL.bs")).map(e.mergeJoin(e.getKeyRange(e.fromTableAscending(a.table("participants")),{hd:d,tl:0}),c),g)}function c(a,c){return b("ReQL.bs").getKeyRange(a,{hd:c,tl:0})}f.empty=e;f.projectOpen=g;f.getAllInOpenThread=a;f.getInOpenThread=c}),null);
__d("MAWUnsupportedBrowsersNuxWrapper.react",["MAWUnsupportedIndexedDBNuxKey","WebStorage","cr:2883","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useState;function a(a){var e=a.children;a=a.marginHorizontal;var f=i(d("MAWUnsupportedIndexedDBNuxKey").getIsDismissed()),g=f[0],j=f[1];f=window.indexedDB!=null&&c("WebStorage").getLocalStorage()!=null;return b("cr:2883")==null||f||g?e:h.jsx(b("cr:2883"),{marginHorizontal:a,onCloseButtonClick:function(){j(!0),d("MAWUnsupportedIndexedDBNuxKey").setIsDismissed()}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSSearchType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];var g=[0,6],h=[0,7],i=[0,8],j=[0,9],k=[0,10],l=[0,11],m=[0,12],n=[0,13];f.contact=a;f.noncontact=c;f.group=d;f.page=e;f.integratedMessageSearchThread=b;f.igContactFollowing=g;f.igContactNonfollowing=h;f.igNoncontactFollowing=i;f.igNoncontactNonfollowing=j;f.igBusiness=k;f.tamContact=l;f.tamThread=m;f.communityMessagingThread=n}),null);
__d("MWLSSearchIssueSearchQuerySupportedTypes.bs",["LSSearchType.bs"],(function(a,b,c,d,e,f){"use strict";c=[(a=b("LSSearchType.bs")).contact,a.group,a.page,a.noncontact,a.igContactFollowing,a.igContactNonfollowing,a.igNoncontactFollowing,a.igNoncontactNonfollowing];d=[a.contact,a.page,a.noncontact,a.igContactFollowing,a.igContactNonfollowing,a.igNoncontactFollowing,a.igNoncontactNonfollowing];e=[a.contact];b=[a.contact,a.group,a.page,a.igContactFollowing,a.igContactNonfollowing,a.igNoncontactFollowing,a.igNoncontactNonfollowing];var g=[a.contact,a.noncontact];a=[a.contact,a.noncontact,a.igContactFollowing,a.igContactNonfollowing,a.igNoncontactFollowing,a.igNoncontactNonfollowing];f.allSupportedTypes=c;f.armadilloSupportedTypes=d;f.onlyContacts=e;f.broadcastFlowSupportedTypes=b;f.addParticipantBase=g;f.addParticipantXac=a}),null);
__d("MWLSSearchIssueSearchQuerySupportedTypes.re",["MWLSSearchIssueSearchQuerySupportedTypes.bs"],(function(a,b,c,d,e,f){c=(a=b("MWLSSearchIssueSearchQuerySupportedTypes.bs")).allSupportedTypes;f.allSupportedTypes=c;d=a.armadilloSupportedTypes;f.armadilloSupportedTypes=d;e=a.onlyContacts;f.onlyContacts=e;b=a.broadcastFlowSupportedTypes;f.broadcastFlowSupportedTypes=b}),null);
__d("LsUniversalSearchEndFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("92");c=b("FalcoLoggerInternal").create("ls_universal_search_end",a);e.exports=c}),null);
__d("LsUniversalSearchResultSelectedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("95");c=b("FalcoLoggerInternal").create("ls_universal_search_result_selected",a);e.exports=c}),null);
__d("MWSearchLogging",["LsUniversalSearchEndFalcoEvent","LsUniversalSearchResultSelectedFalcoEvent","MWJewelSearchTypeaheadHelper.re"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){if(a==="offline"||a==="offline_nullstate"||a==="secure")return[0];return a==="server"?[1,2]:[]};function a(a,b,d,e){var f=d.rawData;d=f.id;var g=parseInt(d,10),i=2;if(g<=0)i=0;else{var j=d,k=5;g=f.serverSearchResult;if(g!=null){d=c("MWJewelSearchTypeaheadHelper.re").getLoggingValues(g);k=d.resultType;i=d.threadType;j=d.resultFbid}var l=((g=f.renderIndex)!=null?g:-1).toString();c("LsUniversalSearchResultSelectedFalcoEvent").log(function(){return{data_sources:h(f.searchSource),instance_id:a,recipient_ids:e,result_index_without_header:l,search_result:{query_string:b,result_fbid:j,result_index:l,result_type:k},thread_type:i,ui_section:0}})}c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:6,instance_id:a,recipient_ids:e,thread_type:i}})}g.logResultSelected=a}),98);
__d("createMWChatSearchTypeaheadDataEntry",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return{key:a.id,label:a.displayName,rawData:{displayName:a.displayName,id:a.id,imageUrl:a.imageUrl,isContact:a.isContact,isE2e:a.isE2e,isGroupsXacEligible:Boolean(a.isGroupsXacEligible),isInstagramAccount:Boolean(a.isInstagramAccount),isInteropEligible:a.isInteropEligible!==!1,isWAEligible:a.isWAEligible,rankingScore:a.rankingScore,renderIndex:b,resultType:a.resultType,searchSource:a.searchSource,secondaryImageUrl:(b=a.secondaryImageUrl)!=null?b:"",section:a.section,serverSearchResult:a.serverSearchResult,subtext:a.subtext,verificationStatus:a.isVerified?"BLUE_VERIFIED":"NOT_VERIFIED",waAddressable:a.waAddressable,waEligibility:a.waEligibility}}}f["default"]=a}),66);
__d("BaseTypeaheadSubscriptionDataSource",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.subscribe=function(a){return this.$2(a)};b.fetchNetwork=function(a,b){};b.publish=function(a){Array.from(this.$1).forEach(function(b){b(a)})};b.$2=function(a){var b=this;this.$1.add(a);return function(){b.$1["delete"](a)}};b.unsubscribe=function(){this.$1.clear()};return a}();f["default"]=a}),66);
__d("LSPlatformWaitForTaskCompletion",["I64","Promise","emptyFunction","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:f=new Set();h=new(b("Promise"))(function(a){g=a});j.next=4;return b("regeneratorRuntime").awrap(a.runInTransaction(function(b){var h=c("emptyFunction"),j=a.table("pending_tasks").subscribe(function(a,b){b.operation==="add"||b.operation==="put"?f.add(d("I64").to_string(a.hd)):f["delete"](d("I64").to_string(a.hd))});h=a.subscribeToCommit(function(){j();h();if(f.size===0)g(i);else{var b=c("emptyFunction");b=a.table("pending_tasks").subscribe(function(a,c){c.operation==="delete"&&(f["delete"](d("I64").to_string(a.hd)),f.size===0&&(b(),g(i)))})}});return e(b)},"readwrite"));case 4:i=j.sent;return j.abrupt("return",h);case 6:case"end":return j.stop()}},null,this)}g["default"]=a}),98);
__d("LSSearchGranularSurfaceType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];var g=[0,6],h=[0,7],i=[0,8],j=[0,9],k=[0,10],l=[0,11],m=[0,12],n=[0,13],o=[0,14],p=[0,15],q=[0,16],r=[0,17];f.universalAll=a;f.universalMorePeople=c;f.universalIgFollowing=d;f.universalBusiness=e;f.omnipicker=b;f.broadcast=g;f.blockList=h;f.impersonationEvidence=i;f.universalIgNonfollowing=j;f.groups=k;f.omnipickerArmadillo=l;f.restrictedList=m;f.callsTab=n;f.cmInviteAllMembers=o;f.instagramAll=p;f.cmMemberList=q;f.cmThreadParticipantSearch=r}),null);
__d("LSSearchRequestStatusType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];f.pending=a;f.complete=c;f.failed=d}),null);
__d("MNetContactItemType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9],l=[0,10],m=[0,11],n=[0,12];f.contact=a;f.nonContact=c;f.group=d;f.page=e;f.bot=b;f.game=g;f.igUser=h;f.igThread=i;f.sticker=j;f.interopThread=k;f.msgrThread=l;f.textSuggestion=m;f.communityMessagingThread=n}),null);
__d("LSInstagramE2EEEligibility.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").neg_one;c=b("bs_caml_int64").zero;d=b("bs_caml_int64").one;e=[0,2];b=[0,3];var g=[0,4];f.unknown=a;f.ineligible=c;f.eligible=d;f.required=e;f.dualSendEligible=b;f.groupsEligible=g}),null);
__d("MWChatTemporarySearchResult.bs",["LSContactBitOffset.bs","LSContactCapabilityBitOffset.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSInstagramE2EEEligibility.bs","LSMediaUrl.bs","LSMessagingThreadTypeUtil.bs","LSSearchType.bs","LSWhatsAppConnectStatus.bs","MWLSContactTypeExactUtils.bs","MWLSThreadTitle.bs","bs_belt_Option","bs_caml","bs_caml_option","bs_int64","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a){if(b("bs_caml").i64_eq(a,b("LSSearchType.bs").igContactFollowing)||b("bs_caml").i64_eq(a,b("LSSearchType.bs").igContactNonfollowing)||b("bs_caml").i64_eq(a,b("LSSearchType.bs").igNoncontactFollowing))return!0;else return b("bs_caml").i64_eq(a,b("LSSearchType.bs").igNoncontactNonfollowing)}function h(a){if(b("bs_caml").i64_eq(a,b("LSSearchType.bs").contact)||b("bs_caml").i64_eq(a,b("LSSearchType.bs").noncontact)||g(a))return"user";else if(b("bs_caml").i64_eq(a,b("LSSearchType.bs").group))return"group";else if(b("bs_caml").i64_eq(a,b("LSSearchType.bs").page))return"page";else if(b("bs_caml").i64_eq(a,b("LSSearchType.bs").integratedMessageSearchThread))return"message";else{b("recoverableViolation")("Unknown Search Result Type "+b("bs_int64").to_string(a),"messenger_web_product");return"user"}}function a(a,c,d,e){a=a!==void 0?b("bs_caml_option").valFromOption(a):void 0;var f=b("MWLSContactTypeExactUtils.bs").isIgContact(c),g=c.secondaryName;g=f&&g!==void 0?g:"";d=d!==void 0?[d.e2eeEligibility,b("bs_caml").i64_neq(d.e2eeEligibility,b("LSInstagramE2EEEligibility.bs").ineligible)]:[void 0,void 0];var h=c.contactType;return{displayName:c.name,id:b("bs_int64").to_string(c.id),imageUrl:b("LSMediaUrl.bs").Contact.profilePictureUrl(c),secondaryImageUrl:void 0,isContact:b("bs_caml").i64_eq(c.contactViewerRelationship,b("LSContactViewerRelationship.bs").contactOfViewer),isE2e:!1,isInstagramAccount:f,isInteropEligible:b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").isXacEligible,c),isGroupsXacEligible:b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").isGroupsXacEligible,c),resultType:b("bs_caml").i64_eq(h,b("LSContactType.bs").user)||!(b("bs_caml").i64_eq(h,b("LSContactType.bs").page)||b("bs_caml").i64_eq(h,b("LSContactType.bs").pagePersona))?"user":"page",subtext:g,isVerified:b("bs_belt_Option").getWithDefault(b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").verified,c),!1),section:"",serverSearchResult:void 0,searchSource:e,threadKey:void 0,rankingScore:a,waAddressable:b("bs_caml").i64_eq(c.waConnectStatus,b("LSWhatsAppConnectStatus.bs").whatsappAddressable),waEligibility:d[0],isWAEligible:d[1],isInvitedToCmChannel:void 0,isEligibleForCmInvite:void 0}}function c(a,c,d,e,f,g){return{displayName:b("MWLSThreadTitle.bs").make(a.threadName,d,g,a.threadType),id:b("bs_int64").to_string(a.threadKey),imageUrl:e,secondaryImageUrl:f,isContact:!1,isE2e:b("LSMessagingThreadTypeUtil.bs").isSecure(a.threadType),isInstagramAccount:!1,isInteropEligible:void 0,isGroupsXacEligible:void 0,resultType:"group",subtext:b("bs_belt_Option").getWithDefault(a.threadDescription,""),isVerified:!1,section:"",serverSearchResult:void 0,searchSource:c,threadKey:a.threadKey,rankingScore:void 0,waAddressable:void 0,waEligibility:void 0,isWAEligible:void 0,isInvitedToCmChannel:void 0,isEligibleForCmInvite:void 0}}function d(a,c,d){var e=b("bs_caml").i64_eq(a.type_,b("LSSearchType.bs").contact),f=g(a.type_);c=c!==void 0?b("bs_belt_Option").getWithDefault(c.displayName,""):"";var i=a.isVerified,j=a.waEligibility;return{displayName:a.displayName,id:a.resultId,imageUrl:a.profilePicUrl,secondaryImageUrl:a.secondaryProfilePicUrl,isContact:e,isE2e:!1,isInstagramAccount:f,isInteropEligible:a.isInteropEligible,isGroupsXacEligible:a.isGroupsXacEligible,resultType:h(a.type_),subtext:e?"":a.contextLine,isVerified:i!==void 0?i:!1,section:c,serverSearchResult:a,searchSource:d,threadKey:void 0,rankingScore:void 0,waAddressable:a.isWaAddressable,waEligibility:a.waEligibility,isWAEligible:j!==void 0?b("bs_caml").i64_neq(j,b("LSInstagramE2EEEligibility.bs").ineligible):void 0,isInvitedToCmChannel:void 0,isEligibleForCmInvite:void 0}}f.checkIsInstagramAccount=g;f.getResultType=h;f.fromContact=a;f.fromThread=c;f.fromServerSearchResult=d}),null);
__d("MWChatSearchFetchContactRecommendations.bs",["LSContactBitOffset.bs","LSContactCapabilityBitOffset.bs","LSContactViewerRelationship.bs","LSDatabaseType.bs","LSMediaUrl.bs","LSPlatformClientSingleton.bs","LSSearchType.bs","LSWhatsAppConnectStatus.bs","MNetContactItemType.bs","MNetRankType.bs","MWChatTemporarySearchResult.bs","MWLSContactTypeExactUtils.bs","MWLSDatabaseLazySync.bs","MessagingThreadType.bs","Promise","ReQL.bs","ReQLSubscription.bs","bs_caml","bs_caml_int64","bs_curry","bs_int64","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function i(a){if(a<0)return-1;else if(a>0)return 1;else return 0}function j(a){return a.sort(function(a,b){b=b[0];var c=b[1];b=b[0];a=a[0];var d=a[1];a=a[0];if(b.score!==a.score)return i(b.score-a.score);else if(d!==void 0)if(c!==void 0)return i(c.rank-d.rank);else return-1;else if(c!==void 0)return 1;else return 0})}function k(a){var c=b("MWLSContactTypeExactUtils.bs").isIgContact(a);a=a.contactViewerRelationship;if(c)if(b("bs_caml").i64_eq(a,b("LSContactViewerRelationship.bs").notContact))return b("LSSearchType.bs").igNoncontactFollowing;else if(b("bs_caml").i64_eq(a,b("LSContactViewerRelationship.bs").contactOfViewer))return b("LSSearchType.bs").igContactFollowing;else return b("LSSearchType.bs").igNoncontactNonfollowing;else return b("LSSearchType.bs").contact}function l(a){var c=[];a.forEach(function(a,d){var e=a[1];a=a[0];var f=a[1];a=a[0];e=e!==void 0?e.e2eeEligibility:void 0;if(f===void 0)return;var g=a.contactType;a=a.contactType;var h=f.secondaryName,i=b("bs_int64").to_string(f.id);d=b("bs_caml_int64").of_int32(d);g=b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").contact)?k(f):b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").group)?b("LSSearchType.bs").group:b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").page)?b("LSSearchType.bs").page:b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").nonContact)?b("LSSearchType.bs").noncontact:b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").igThread)||b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").interopThread)||b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").msgrThread)?b("LSSearchType.bs").integratedMessageSearchThread:b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").igUser)?b("LSSearchType.bs").igContactFollowing:b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").bot)||b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").game)||b("bs_caml").i64_eq(g,b("MNetContactItemType.bs").sticker)?b("LSSearchType.bs").page:b("LSSearchType.bs").noncontact;a=b("bs_caml").i64_eq(a,b("MNetContactItemType.bs").group)?b("MessagingThreadType.bs").group:b("MessagingThreadType.bs").oneToOne;var j=f.name,l=b("LSMediaUrl.bs").Contact.profilePictureUrl(f);h=h!==void 0?h:"";var m=f.blockedByViewerStatus,n=b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").verified,f),o=b("MWLSContactTypeExactUtils.bs").isIgContact(f)?b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").isXacEligible,f):void 0,p=b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").isGroupsXacEligible,f),q=b("bs_caml").i64_eq(f.waConnectStatus,b("LSWhatsAppConnectStatus.bs").whatsappAddressable);i={query:"",resultId:i,globalIndex:d,type_:g,threadType:a,displayName:j,profilePicUrl:l,secondaryProfilePicUrl:void 0,contextLine:h,messageId:void 0,messageTimestampMs:void 0,blockedByViewerStatus:m,isVerified:n,isInteropEligible:o,isGroupsXacEligible:p,isWaAddressable:q,waEligibility:e,isInvitedToCmChannel:void 0,isEligibleForCmInvite:void 0};d=b("MWChatTemporarySearchResult.bs").fromServerSearchResult(i,void 0,"offline_nullstate");c.push([d,f])});return c}function m(a,c){var d;return(d=b("ReQL.bs")).leftJoin(d.leftJoin(d.getKeyRange(d.fromIndexAscending(a.table("ranking_scores").index("scoreTypeContactId")),{hd:c,tl:0}),d.fromTableAscending(a.table("contacts"))),d.fromTableAscending(a.table("ig_contact_info")))}function n(a,c){var d=a!==void 0?a:b("MNetRankType.bs").messengerUserSearchNullstate,e=b("useReStore")(),f=b("ReQLSubscription.bs").useArray(h.useMemo(function(){return m(e,d)},[d,e]));return h.useMemo(function(){return l(j(f))},[f])}function a(a){var c=b("MWLSDatabaseLazySync.bs").useSync(b("LSDatabaseType.bs").ranking);a=n(b("MNetRankType.bs").inboxActiveNow,void 0);h.useEffect(function(){b("bs_curry")._1(c,void 0)},[c]);return a.length}function c(a,c){var d=a!==void 0?a:b("MNetRankType.bs").messengerUserSearchNullstate;return b("LSPlatformClientSingleton.bs").getDB(void 0).then(function(a){return b("ReQL.bs").toArray(m(a,d))}).then(function(a){return b("Promise").resolve(l(j(a)))})}f.sortInPlaceQueryResults=j;f.matchContactType=k;f.mapToServerSearchResults=l;f.makeQuery=m;f.useHook=n;f.useActiveContactCount=a;f.fetchRecommendations=c}),null);
__d("MWChatSearchIssueLightspeedQuery.bs",["LS.bs","LSContactBlockedByViewerStatus.bs","LSIssueSearchQuery","LSPlatformClientSingleton.bs","LSPlatformWaitForTaskCompletion","LSSearchGranularSurfaceType.bs","LSSearchRequestStatusType.bs","LSSearchType.bs","LSTransaction.bs","LSVec.bs","MNetRankType.bs","MWChatSearchFetchContactRecommendations.bs","MWChatTemporarySearchResult.bs","Promise","ReQL.bs","ReQLSubscription.bs","bs_caml","bs_caml_array","bs_caml_exceptions","bs_curry","bs_int64","gkx"],(function(a,b,c,d,e,f){"use strict";var g,h=b("bs_caml_exceptions").create("MWChatSearchIssueLightspeedQuery.FailedToFetchSearchResults"),i=b("gkx")("4164");function a(a){return b("bs_caml").i64_eq(a,b("LSSearchType.bs").contact)}function j(a){var c=a[1];a=a[0];var d=[],e=0;a.sort(function(a,c){return b("bs_int64").compare(a.globalIndex,c.globalIndex)});c.sort(function(a,c){return b("bs_int64").compare(a.globalIndex,c.globalIndex)});for(var f=0,g=a.length;f<g;++f){var h=b("bs_caml_array").get(a,f);while(e<c.length&&b("bs_caml").i64_ge(b("bs_caml_array").get(c,e).globalIndex,h.startIndex)&&b("bs_caml").i64_le(b("bs_caml_array").get(c,e).globalIndex,h.endIndex)){var i=b("bs_caml_array").get(c,e);d.push(b("MWChatTemporarySearchResult.bs").fromServerSearchResult(i,h,"server"));e=e+1|0}}return d}var k=[b("LSSearchType.bs").integratedMessageSearchThread];g={universal:(g=b("LSSearchGranularSurfaceType.bs")).universalAll,broadcast:g.broadcast,omnipickerArmadillo:g.omnipickerArmadillo,instagramAll:g.instagramAll,cmInviteAllMembers:g.cmInviteAllMembers};function l(a,c,d){var e=d.query;return b("LSPlatformClientSingleton.bs").getDB(void 0).then(function(d){return b("LSTransaction.bs").run(d,function(d){return b("LSIssueSearchQuery")(e,b("LSVec.bs").make(a),void 0,c,void 0,void 0,b("LS.bs").make(d))},"readWrite").then(function(a){return d})})}function c(a,c,d){return b("LSPlatformClientSingleton.bs").getDB(void 0).then(function(e){return b("LSPlatformWaitForTaskCompletion")(e,function(e){return b("LSIssueSearchQuery")(d.query,b("LSVec.bs").make(a),void 0,c,void 0,void 0,b("LS.bs").make(e))}).then(function(a){return e})}).then(function(a){var c,e=(c=b("ReQL.bs")).toArray(c.filter(c.getKeyRange(c.fromTableAscending(a.table("server_search_results")),{hd:d.query,tl:0}),function(a){return b("bs_caml").i64_eq(a.blockedByViewerStatus,b("LSContactBlockedByViewerStatus.bs").unblocked)}));c=c.toArray(c.getKeyRange(c.fromTableAscending(a.table("server_search_sections")),{hd:d.query,tl:0}));return b("Promise").all([c,e]).then(j)})}function d(a,c,d,e){return b("MWChatSearchFetchContactRecommendations.bs").fetchRecommendations(e,void 0).then(function(a){return b("Promise").resolve(a.map(function(a){return a[0]}))})}function m(a,c,d){var e,f=(e=b("ReQL.bs")).filter(e.getKeyRange(e.fromTableAscending(a.table("server_search_results")),{hd:c,tl:0}),function(a){return b("bs_caml").i64_eq(a.blockedByViewerStatus,b("LSContactBlockedByViewerStatus.bs").unblocked)}),g=e.getKeyRange(e.fromTableAscending(a.table("server_search_sections")),{hd:c,tl:0});e=e.getKeyRange(e.fromTableAscending(a.table("search_queries")),{hd:c,tl:0});c=function(a){var c=a[0];if(c===void 0)return;var e=a[1];if(e===void 0)return;a=a[2];if(a===void 0)return;if(a.length!==1)return;a=a[0];if(!i||b("bs_caml").i64_neq(a.statusPrimary,b("LSSearchRequestStatusType.bs").pending))return b("bs_curry")._1(d,j([e,c]))};return b("ReQLSubscription.bs").combineLatest3(a,f,g,e,c)}function e(a,b,c,d,e){l(b,c,d);return m(a,d.query,e)}function n(a,c,d,e,f){l(c,d,e);c=b("MWChatSearchFetchContactRecommendations.bs").makeQuery(a,b("MNetRankType.bs").messengerUserSearchNullstate);d=function(a){if(a!==void 0)return b("bs_curry")._1(f,b("MWChatSearchFetchContactRecommendations.bs").mapToServerSearchResults(b("MWChatSearchFetchContactRecommendations.bs").sortInPlaceQueryResults(a)).map(function(a){return a[0]}))};return b("ReQLSubscription.bs").subscribe(a,c,d)}f.FailedToFetchSearchResults=h;f.loaderIndicatorFix=i;f.checkIsContact=a;f.toSearchResults=j;f.contentSearchTypes=k;f.Surfaces=g;f.fetchResults=c;f.fetchRecommendations=d;f.subscribe=m;f.requestResults=e;f.requestRecommendations=n}),null);
__d("MWChatSearchIssueLightspeedQuery.re",["MWChatSearchIssueLightspeedQuery.bs","bs_curry"],(function(a,b,c,d,e,f){c=(a=b("MWChatSearchIssueLightspeedQuery.bs")).contentSearchTypes;f.contentSearchTypes=c;d=a.Surfaces.universal;f.Surfaces_universal=d;e=a.Surfaces.broadcast;f.Surfaces_broadcast=e;c=a.Surfaces.omnipickerArmadillo;f.Surfaces_omnipickerArmadillo=c;d=a.Surfaces.instagramAll;f.Surfaces_instagramAll=d;e=a.Surfaces.cmInviteAllMembers;f.Surfaces_cmInviteAllMembers=e;c=a.fetchResults;f.fetchResults=c;d=a.fetchRecommendations;f.fetchRecommendations=d;e=function(a,c,d,e){a=b("bs_curry")._4(b("MWChatSearchIssueLightspeedQuery.bs").subscribe,a,c,d,e);return a};f.subscribe=e;c=a.requestResults;f.requestResults=c;d=a.requestRecommendations;f.requestRecommendations=d;e=a.Surfaces;f.Surfaces=e}),null);
__d("mwChatSearchPayloadEnumerate",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.entries;a=babelHelpers.objectWithoutPropertiesLoose(a,["entries"]);b=b.map(function(a,b){var c=a.key,d=a.label;a=a.rawData;return{key:c,label:d,rawData:babelHelpers["extends"]({},a,{renderIndex:b})}});return babelHelpers["extends"]({entries:b},a)}f["default"]=a}),66);
__d("mwStaticSearchEntries",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{key:a,label:'Search messages for "'+a+'"',rawData:{displayName:'Search messages for "'+a+'"',id:a,imageUrl:"",isContact:!1,isE2e:!1,resultType:"messages",secondaryImageUrl:"",subtext:""}}}f.createMessageSearchEntry=a}),66);
__d("MWChatSearchTypeaheadLightspeedSubscriptionDataSource",["BaseTypeaheadSubscriptionDataSource","FBLogger","MWChatSearchIssueLightspeedQuery.re","MWLSSearchIssueSearchQuerySupportedTypes.re","Promise","cr:10864","cr:3071","createMWChatSearchTypeaheadDataEntry","gkx","mwChatSearchPayloadDecoratorRemoveDuplicates","mwChatSearchPayloadDecoratorRemoveExcluded","mwChatSearchPayloadEnumerate","mwStaticSearchEntries","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";a=c("gkx")("4164");var h=a&&((e=c("qex")._("73"))!=null?e:!1),i=(f=c("qex")._("962"))!=null?f:a?10:0,j=(e=c("qex")._("963"))!=null?e:a?10:0;f=function(a){babelHelpers.inheritsLoose(e,a);function e(b){var d,e=b.database,f=b.excludedIDs;f=f===void 0?[]:f;var g=b.lightspeedSupportedTypes;g=g===void 0?c("MWLSSearchIssueSearchQuerySupportedTypes.re").allSupportedTypes:g;var h=b.source;h=h===void 0?c("MWChatSearchIssueLightspeedQuery.re").Surfaces.universal:h;var i=b.includeRecommendations;i=i===void 0?!0:i;b=b.includeThreadSearch;b=b===void 0?!1:b;d=a.call(this)||this;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource1=[];d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource2=[];d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource6=function(){};d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource2=f;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource3=h===c("MWChatSearchIssueLightspeedQuery.re").Surfaces.omnipickerArmadillo?c("MWLSSearchIssueSearchQuerySupportedTypes.re").armadilloSupportedTypes:g;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource4=h;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource5=e;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource7=i;d.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource8=b;return d}var f=e.prototype;f.unsubscribe=function(){a.prototype.unsubscribe.call(this),this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource6()};f.fetchNetwork=function(a,d){var e=this;this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource6();if(a.query.length===0&&!this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource7)return this.publish({entries:[],params:a});d(!0);if(a.query.length===0){this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource6=c("MWChatSearchIssueLightspeedQuery.re").requestRecommendations(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource5,this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource3,this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource4,a,function(b){e.onData(a,b),d(!1)});return}var f=[],g=[],k=!1;c("promiseDone")(b("Promise").all([b("cr:10864")!=null?b("cr:10864").fetchResults(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource3,this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource4,a):b("Promise").resolve([]),b("cr:3071")!=null&&(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource4!==c("MWChatSearchIssueLightspeedQuery.re").Surfaces.broadcast||h)?b("cr:3071").search(a.query):b("Promise").resolve([])]).then(function(b){var c=b[0];b=b[1];b=i<=0?b:b.slice(0,i);c=j<=0?c:c.slice(0,j);f=b.concat(c);k||e.onData(a,f.concat(g))})["catch"](function(a){c("FBLogger")("messenger_search").catching(a).mustfix("Error performing MWChatSearchIssueMAWFTSQuery.fetchResults")}));var l=c("MWChatSearchIssueLightspeedQuery.re").requestResults(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource5,this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource3,this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource4,a,function(b){g=b,e.onData(a,f.concat(g)),d(!1)});this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource6=function(){d(!1),l(),k=!0}};f.onData=function(a,b){b=b.map(c("createMWChatSearchTypeaheadDataEntry"));b=[].concat(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource8&&a.query.length?[d("mwStaticSearchEntries").createMessageSearchEntry(a.query)]:[],b);var e=[],f=new Set();for(var b=b,g=Array.isArray(b),h=0,b=g?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=b.length)break;i=b[h++]}else{h=b.next();if(h.done)break;i=h.value}i=i;f.has(i.key)||(e.push(i),f.add(i.key))}i={entries:e,params:a};h=c("mwChatSearchPayloadDecoratorRemoveDuplicates")(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource1);g=c("mwChatSearchPayloadDecoratorRemoveExcluded")(this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource2);b=c("mwChatSearchPayloadEnumerate")(g(h(i)));this.publish(b)};f.setExcludedIds=function(a){this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource2=a};f.setTokens=function(a){this.$MWChatSearchTypeaheadLightspeedSubscriptionDataSource1=a};return e}(c("BaseTypeaheadSubscriptionDataSource"));g["default"]=f}),98);
__d("MWChatSearchClearSearchResults.bs",["LS.bs","LSClearTables","LSTransaction.bs","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")();return h.useCallback(function(a){a=b("LSTransaction.bs").run(c,function(a){return b("LSClearTables")(b("LS.bs").make(a))},"readWrite");b("promiseDone")(a,void 0,void 0)},[c])}f.useHook=a}),null);
__d("MWChatSearchClearSearchResults.re",["MWChatSearchClearSearchResults.bs"],(function(a,b,c,d,e,f){a=b("MWChatSearchClearSearchResults.bs").useHook;f.useHook=a}),null);
__d("MWChatSearchInsertRankingContacts.bs",["LS.bs","LSInsertRankingContacts","LSTransaction.bs","bs_caml","bs_caml_int64","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";var g={contents:!1},h=b("gkx")("4164")?[0,100]:b("bs_caml_int64").zero;function a(a){if(!g.contents&&b("bs_caml").i64_gt(h,b("bs_caml_int64").zero)){g.contents=!0;b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSInsertRankingContacts")(h,b("LS.bs").make(a))},"readWrite"),void 0,void 0);return}}f.rankingContactsStarted=g;f.numRankingContacts=h;f.insertRankingContacts=a}),null);
__d("MWPAreThreadsLoadingInThreadList.bs",["LSDatabaseType.bs","LSSyncStatus.bs","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_belt_Option","bs_caml","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")(),d=b("bs_belt_Option").getWithDefault(b("ReQLSubscription.bs").useFirst(h.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("threads_ranges_v2__generated")),{hd:a,tl:0}),function(a){return a.isLoadingBefore})},[c,JSON.stringify(a)])),!1),e=b("bs_belt_Option").mapWithDefault(b("ReQLSuspense").useFirst(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("sync_groups")),{hd:b("LSDatabaseType.bs").mailbox,tl:0})},[c]),!1,function(a){return b("bs_caml").i64_eq(a.syncStatus,b("LSSyncStatus.bs").complete)});if(e)return d;else return!0}f.useHook=a}),null);
__d("MWThreadListFocusableTable.react",["FocusTable.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");a=d("FocusTable.react").createFocusTable(d("focusScopeQueries").tabbableScopeQuery);var i=a[0];b=a[1];c=a[2];e=function(a){return h.jsx(i,{allowModifiers:!0,tabScopeQuery:d("focusScopeQueries").tabbableScopeQuery,wrapX:!0,children:a.children})};g.MWThreadListFocusableTableRow=b;g.MWThreadListFocusableTableCell=c;g.MWThreadListFocusableTableScopeQuery=d("focusScopeQueries").tabbableScopeQuery;g.MWThreadListFocusableTable=e}),98);
__d("MWPThreadItemsContainer.react",["FocusRegion.react","MWThreadListFocusableTable.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.children;a=a.gridLabel;return h.jsx("div",{"aria-label":a,"data-testid":void 0,role:"grid",children:h.jsx(d("FocusRegion.react").FocusRegion,{autoRestoreFocus:!0,recoverFocusQuery:d("focusScopeQueries").tabbableScopeQuery,children:h.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTable,{children:b})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWPInfiniteThreadList.bs",["CometHeroHoldTrigger.react","CometInfiniteScrollTrigger.react","CometSettingsListDropdownLoadingState.react","MWIsXacGroupThread.bs","MWLSJewelHasReachedEnd.bs","MWLSJewelLoadMoreThreads.bs","MWPAreThreadsLoadingInThreadList.bs","MWPThreadItemsContainer.react","MWPThreadsForThreadList.bs","MWThreadListSupportedThreadTypes.bs","MWXacGating.bs","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_belt_Array","bs_belt_Option","bs_caml","bs_caml_option","bs_curry","react","stylex","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j={noOverflow:{overflowX:"ni8dbmo4",overflowY:"stjgntxs"}};function k(a,c,d,e){var f=a.length,g=i.useState(function(){return b("bs_caml").caml_int_max(5,b("bs_caml").caml_int_min(30,window.screen.availHeight/56|0))}),h=g[1],j=g[0];g=i.useMemo(function(){return b("bs_belt_Array").slice(a,0,j)},[a,j]);var k=i.useCallback(function(a){if(j<f)return b("bs_curry")._1(h,function(a){return j+15|0});else return c()},[f,j,h,c]);return[g,k,d&&j>=f,e&&j>=f]}function a(a){var c=a.beforeContent,d=a.afterContent,e=a.gridLabel,f=a.renderItem,g=a.itemPlaceholder,l=a.emptyContent,m=a.onLoadMoreThreads,n=a.parentThreadKey;a=c!==void 0?b("bs_caml_option").valFromOption(c):null;c=d!==void 0?b("bs_caml_option").valFromOption(d):null;d=g!==void 0?b("bs_caml_option").valFromOption(g):null;g=l!==void 0?b("bs_caml_option").valFromOption(l):null;var o=m!==void 0?m:function(a){},p=b("useReStore")(),q=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(p.table("threads_ranges_v2__generated")),{hd:n,tl:0})},[p,JSON.stringify(n)]));l=b("ReQLSuspense").useArray(function(){return b("ReQL.bs").filter(b("ReQL.bs").filter(b("MWPThreadsForThreadList.bs").createIterable(p,n,q),function(a){return b("MWThreadListSupportedThreadTypes.bs").supportedThreadTypes.findIndex(function(c){return b("bs_caml").i64_eq(a.threadType,c)})!==-1}),function(a){if(b("MWXacGating.bs").isGroupsEnabled(void 0))return!0;else return!b("MWIsXacGroupThread.bs").check(a)})},[p,n,q]);var r=b("MWLSJewelLoadMoreThreads.bs").useHook(n);m=b("MWLSJewelHasReachedEnd.bs").useHook(n);var s=b("MWPAreThreadsLoadingInThreadList.bs").useHook(n),t=i.useMemo(function(){return function(){r();return b("bs_curry")._1(o,void 0)}},[r,o]);l=k(l,t,m,s);t=l[3];m=l[0];if(m.length!==0)return i.jsx(b("MWPThreadItemsContainer.react"),{gridLabel:e,children:i.jsxs(i.Fragment,{children:[a,m.map(function(a){return i.jsx(i.Fragment,{children:b("bs_curry")._1(f,a)},b("bs_belt_Option").getExn(JSON.stringify(a.threadKey)))}),c,i.jsx(b("CometInfiniteScrollTrigger.react"),{hasMore:!l[2],isLoading:t,onLoadMore:l[1],children:d})]})});if(t)return i.jsxs("div",{className:(h||(h=b("stylex")))(j.noOverflow),children:[i.jsx(b("CometHeroHoldTrigger.react"),{description:"Jewel Query",hold:!0}),i.jsx(b("CometSettingsListDropdownLoadingState.react").InnerGlimmer,{size:56})]});s=i.jsxs(i.Fragment,{children:[a,g,c]});e={children:s,className:(h||(h=b("stylex")))(j.noOverflow)};return i.jsx("div",(e["data-testid"]="MWJewelThreadListContainer",e))}c=56;d=a;f.threadlistItemHeight=c;f.styles=j;f.make=d}),null);
__d("MWBaseThreadList.bs",["fbt","MWPFolderFocusedManager.bs","MWPInfiniteThreadList.bs","MWPMarkSeen.bs","MWText.react","ReQL.bs","SortedAsyncIterable.bs","UserActivity","bs_caml_option","bs_curry","react","useReStore","useSimpleImpression","useVisibilityObserver"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||b("react");function a(a){b("useSimpleImpression")(a)}function c(a){var c=a.parentThreadKey,d=a.beforeContent,e=a.afterContent,f=a.gridLabel,h=a.renderItem,j=a.onLoadMoreThreads;a=a.itemPlaceholder;d=d!==void 0?b("bs_caml_option").valFromOption(d):null;e=e!==void 0?b("bs_caml_option").valFromOption(e):null;j=j!==void 0?j:function(a){};a=a!==void 0?b("bs_caml_option").valFromOption(a):null;var k=b("useReStore")(),l=i.useRef(!1),m=b("useVisibilityObserver")({onHidden:function(a){l.current=!1},onVisible:function(a){l.current=!0}});b("MWPFolderFocusedManager.bs").useWatchFocusChanges(c,l);var n=b("MWPMarkSeen.bs").useHook(c);b("useSimpleImpression")(n);i.useEffect(function(){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").take(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexDescending(k.table("threads").index("parentThreadKeyLastActivityTimestampMs")),{hd:c,tl:0}),1),function(a,c){if(b("UserActivity").isOnTab()&&l.current)return b("bs_curry")._1(n,void 0)})},[k,c,l]);return i.jsx("div",{ref:m,children:i.jsx(b("MWPInfiniteThreadList.bs").make,{beforeContent:d,afterContent:e,gridLabel:f,renderItem:h,itemPlaceholder:a,emptyContent:i.jsx("div",{className:"dati1w0a ihqw7lf3 hv4rvrfc discj3wi",children:i.jsx(b("MWText.react"),{align:"center",type:"body2",children:g._(/*FBT_CALL*/"\u0915\u094b\u0908 \u0938\u0902\u0926\u0947\u0936 \u0928\u0939\u0940\u0902 \u092e\u093f\u0932\u093e."/*FBT_CALL*/)})}),onLoadMoreThreads:j,parentThreadKey:c})})}d=c;f.useSimpleImpression=a;f.make=d}),null);
__d("FBGroupChatInviteState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];var g=[0,6];f.accepted=a;f.active=c;f.declinedByReceiver=d;f.ignoredByReceiver=e;f.deletedBySender=b;f.discarded=g}),null);
__d("MWPThreadListItemInviteAddOn.react",["fbt","MDSCircleButton.react","MDSRow.react","MDSRowItem.react","MWPBumpEntityKey.re","MessengerCheckmark.svg.react","MessengerCross.svg.react","SVGIcon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=h._(/*FBT_CALL*/"\u0906\u092e\u0902\u0924\u094d\u0930\u0923 \u0938\u094d\u0935\u0940\u0915\u093e\u0930 \u0915\u0930\u0947\u0902"/*FBT_CALL*/),k=h._(/*FBT_CALL*/"\u0906\u092e\u0902\u0924\u094d\u0930\u0923 \u0905\u0938\u094d\u0935\u0940\u0915\u093e\u0930 \u0915\u0930\u0947\u0902"/*FBT_CALL*/);a=function(a){var b=a.onAccept,e=a.onDecline;return i.jsxs(c("MDSRow.react"),{paddingHorizontal:0,paddingVertical:0,verticalAlign:"center",children:[i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MDSCircleButton.react"),{icon:d("SVGIcon").svgIcon(c("MessengerCheckmark.svg.react")),label:j,onPress:function(a){d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("mw.sidebar","thread_invite.accept"),b()},size:32})}),i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MDSCircleButton.react"),{icon:d("SVGIcon").svgIcon(c("MessengerCross.svg.react")),label:k,onPress:function(a){d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("mw.sidebar","thread_invite.decline"),e()},size:32})})]})};b=a;g["default"]=b}),98);
__d("MWThreadListLastMessage.bs",["fbt","CometMiddot.react","CometRelativeTimestamp.react","Locale","MAWGating.bs","MWJewelThreadSnippet.react","MWText.react","MWVerticalRhythm.bs","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react"),k={middot:{marginTop:"kvgmc6g5",marginEnd:"cgat1ltu",marginBottom:"oygrvhab",marginStart:"kkf49tns"},root:{alignItems:"bp9cbjyn",display:"j83agx80",color:"m9osqain",minHeight:"frgo5egb"},rootRtl:{flexDirection:"rl25f0pe"},timestamp:{whiteSpace:"g0qnabr5"}};function l(a){a=a.timestamp;return j.jsxs(j.Fragment,{children:[j.jsx("span",{className:(i||(i=b("stylex")))(k.middot),children:j.jsx(b("MWText.react"),{type:"body4",children:j.jsx(b("CometMiddot.react"),{})})}),j.jsx("span",{"data-testid":"timestamp",className:i(k.timestamp),children:j.jsx(b("CometRelativeTimestamp.react"),{date:new Date(a),format:"minimized"})})]})}c={make:l};function a(a){var c=a.hasOngoingCall,d=a.lastMessageTimestamp,e=a.snippet,f=a.isUnread;a=a.showTimestamp;return j.jsxs(j.Fragment,{children:[j.jsxs("div",{"data-testid":"threadlist-last-message",className:(i||(i=b("stylex")))(k.root,b("Locale").isRTL()?k.rootRtl:!1),children:[j.jsx(b("MWJewelThreadSnippet.react"),{isUnread:f,text:e}),a&&d!==void 0&&d>0?j.jsx(l,{timestamp:d}):null]}),c?j.jsxs(j.Fragment,{children:[b("MAWGating.bs").isArmadillo(void 0)?j.jsx(b("MWVerticalRhythm.bs").make,{height:5}):null,j.jsx(b("MWText.react"),{color:"positive",type:"body4",numberOfLines:1,children:g._(/*FBT_CALL*/"\u091c\u093e\u0930\u0940 \u0915\u0949\u0932"/*FBT_CALL*/)})]}):null]})}d=a;f.styles=k;f.Timestamp=c;f.make=d}),null);
__d("MWUseLastMessageDeliveryStatusIcon.bs",["MWMessageDeliveryStatus.bs","MWMessageDeliveryStatusIcons.bs","ReQL.bs","ReQLSubscription.bs","bs_caml","bs_caml_int64","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a,c,d,e){var f=b("useReStore")(),g=b("ReQLSubscription.bs").useFirst(h.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexDescending(f.table("messages").index("messageDisplayOrder")),{hd:a,tl:0})},[JSON.stringify(a)]));return h.useMemo(function(){if(g===void 0)return null;if(!b("bs_caml").i64_eq(g.senderId,e))return null;var a={contents:b("bs_caml_int64").zero},f={contents:b("bs_caml_int64").zero};d.forEach(function(c){if(b("bs_caml").i64_neq(c.contact_id,e)){a.contents=b("bs_caml").i64_gt(c.delivered_watermark_timestamp_ms,a.contents)?c.delivered_watermark_timestamp_ms:a.contents;f.contents=b("bs_caml").i64_gt(c.read_watermark_timestamp_ms,f.contents)?c.read_watermark_timestamp_ms:f.contents;return}});var i=b("bs_caml").i64_gt(c,f.contents);i=b("MWMessageDeliveryStatus.bs").deliveryStatusForMessageSentByYou(g,a.contents,i);if(typeof i!=="number")return null;switch(i){case 0:return null;case 1:return h.jsx(b("MWMessageDeliveryStatusIcons.bs").Sending.make,{size:2,xstyle:!1});case 2:return h.jsx(b("MWMessageDeliveryStatusIcons.bs").Sent.make,{size:2,xstyle:!1});case 3:return h.jsx(b("MWMessageDeliveryStatusIcons.bs").Delivered.make,{size:2,xstyle:!1});case 4:return h.jsx(b("MWMessageDeliveryStatusIcons.bs").$$Error.make,{size:2,xstyle:!1})}},[f,a,c,d,e,g])}f.useHook=a}),null);
__d("MWV2UseThreadAddOnSecondary.bs",["fbt","CometBadge.react","CometPressable.react","CurrentEnvironment","MAWGating.bs","MWJewelThreadAddOnSecondaryIcons","MWLSMarkThreadAsRead.bs","MWMessageDeliveryStatusIcons.bs","TetraOverlappingFacepileUnstyled.react","bs_caml_obj","bs_curry","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react"),k={container:{alignItems:"bp9cbjyn",display:"j83agx80",flexWrap:"owycx6da"},separator:{width:"xthkpp0z"}};function a(a){var c=a.isUnread,d=a.isMuted,e=a.isViewerSender,f=a.seenByImages,h=a.lastMessageDeliveryStatusIcon,l=a.seenByScreenReaderText;a=a.isSecureGroupThread;var m=b("MWLSMarkThreadAsRead.bs").useHook(void 0),n=[];d&&n.push(b("MWJewelThreadAddOnSecondaryIcons").MWJewelThreadAddOnSecondaryIcons.bell);c?n.push(j.jsx(b("CometPressable.react"),{"aria-label":g._(/*FBT_CALL*/"'\u092a\u0922\u093c \u0932\u093f\u092f\u093e \u0939\u0948' \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u092e\u093e\u0930\u094d\u0915 \u0915\u0930\u0947\u0902"/*FBT_CALL*/),expanding:!0,onPress:function(a){return b("bs_curry")._1(m,void 0)},children:j.jsx(b("CometBadge.react"),{color:"blue",isProfileBadge:!0,size:b("MAWGating.bs").isArmadillo(void 0)&&b("CurrentEnvironment").messengerdotcom?10:12})})):e&&(f.length===0?n.push(h):a?n.push(j.jsx(b("MWMessageDeliveryStatusIcons.bs").DeliveredAndRead.make,{size:2,xstyle:!1})):n.push(j.jsx(b("TetraOverlappingFacepileUnstyled.react"),{count:f.length,isTextInline:!0,items:f.map(function(a){return{alt:a.alt,source:{uri:a.src}}}),size:16,screenReaderLabel:l})));return j.jsx("div",{className:(i||(i=b("stylex")))(k.container),children:n.filter(function(a){return b("bs_caml_obj").caml_notequal(a,null)}).map(function(a,c){return j.jsxs(j.Fragment,{children:[c!==0?j.jsx("div",{className:(i||(i=b("stylex")))(k.separator)}):null,a]},"item_"+String(c))})})}c=j.memo(a);f.styles=k;f.make=c}),null);
__d("RTWebInboxJoinOngoingCallIcon.react",["ix","TetraIcon.react","fbicon","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=function(a,b,c){if(b===!0)return k.camcorder[c];switch(a){case"AUDIO_GROUP_CALL":return k.phone[c];case"VIDEO_GROUP_CALL":return k.camcorder[c];default:return null}};function a(a){var b=a.hasActiveRoom,d=a.hidden,e=a.ongoingCallType;a=a.size;a=a===void 0?36:a;if(d)return null;d=j(e,b,a);return d===null?null:i.jsx("div",{className:c("stylex")(m.buttonContainer),children:i.jsx("div",{className:c("stylex")(m.button,l[a]),children:i.jsx(c("TetraIcon.react"),{color:"white",icon:d})})})}a.displayName=a.name+" [from "+f.id+"]";var k={camcorder:{32:d("fbicon")._(h("493173"),16),36:d("fbicon")._(h("493174"),20)},phone:{32:d("fbicon")._(h("558160"),16),36:d("fbicon")._(h("558161"),20)}},l={32:{height:"k7cz35w2",width:"bsnbvmp4"},36:{height:"tv7at329",width:"thwo4zme"}},m={button:{alignItems:"bp9cbjyn",backgroundImage:"h5vs1ck6",borderTopStartRadius:"s45kfl79",borderTopEndRadius:"emlxlaya",borderBottomEndRadius:"bkmhp75w",borderBottomStartRadius:"spb7xbtv",borderTopWidth:"rt8b4zig",borderEndWidth:"n8ej3o3l",borderBottomWidth:"agehan2d",borderStartWidth:"sk4xxmp2",boxSizing:"rq0escxv",display:"j83agx80",justifyContent:"taijpn5t",paddingTop:"jb3vyjys",paddingEnd:"rz4wbd8a",paddingBottom:"qt6c0cv9",paddingStart:"a8nywdso",position:"l9j0dhe7"},buttonContainer:{borderTopStartRadius:"s45kfl79",borderTopEndRadius:"emlxlaya",borderBottomEndRadius:"bkmhp75w",borderBottomStartRadius:"spb7xbtv",boxShadow:"akv41dx8",end:"rm21btxo",pointerEvents:"mrt03zmi",position:"pmk7jnqg",top:"rk01pc8j",transform:"ke6wolob"}};g["default"]=a}),98);
__d("MWPThreadListItem.bs",["fbt","CometCardedDialogLoadingState.re","CometEntryPointDialogTrigger.react","CometListCellHoverButton.react","CometTextWithEntities.react","CometTransientDialogProvider.react","CommunityMessagingEnableState.bs","FBGroupChatInviteState.bs","FBID.bs","GroupsCometJoinChatDialog.entrypoint","LS.bs","LSMessagingThreadTypeUtil.bs","LSRtcCallState.bs","LSThreadTitle.bs","LSTransaction.bs","LSUpdateCommunityChannelDirectInvite","LsMessengerThreadDamagingActionsEntryPoint.bs","LsSystemFolder.bs","MDSListCell.react","MWCMThreadTypes.bs","MWCMUseFolder.bs","MWCMUseShouldGoToFullScreenChat.bs","MWChatCalculateIsMutedFromExpireTime.bs","MWChatTextTransform.bs","MWLSGetLearningSpaceRoomOnThread.bs","MWLSJewelThreadSeenByImages.bs","MWLSParticipant.bs","MWLSThreadDisplayContext.bs","MWLSThreadSnippetForDisplay.bs","MWPActor.bs","MWPIsThreadUnread.bs","MWPThreadListItemInviteAddOn.react","MWSelectedThreadOptionsIdContext.bs","MWText.react","MWThreadListFocusableTable.react","MWThreadListLastMessage.bs","MWThreadPicture.bs","MWUseLastMessageDeliveryStatusIcon.bs","MWV2OpenTabOrThread.bs","MWV2PreloadThread.bs","MWV2UseThreadAddOnSecondary.bs","MWVerticalRhythm.bs","MessageRequestsBulkActionsContext.react","MessageRequestsBulkActionsThreadListItem.bs","MessengerMuteUtils.bs","RTCCallState.bs","RTWebInboxJoinOngoingCallIcon.react","ReQL.bs","ReQLSubscription.bs","UseBlockedUserInterstitial.bs","bs_belt_Option","bs_caml","bs_caml_int64","bs_curry","bs_int64","cometPushToast","gkx","promiseDone","react","requireDeferred","stylex","useGroupsCometCMOffboardingEntryPointDialog","useMatchMedia","useMenuButtonVisibilityState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react");c={};d={};var k={listItemContainer:{paddingEnd:"dflh9lhu",paddingStart:"scb9dxdr",position:"l9j0dhe7"},listItemContainerForMessengerDotCom:{paddingEnd:"p8fzw8mz",paddingStart:"pcp91wgn"}},l=b("requireDeferred")("MWThreadListHoverButtonDropdownMenu.bs").__setRef("MWPThreadListItem.bs");function a(a){var c=a.messagingEntrypoint,d=a.onClose,e=a.selected,f=a.thread,h=a.responsive,m=a.lsEntryPoint,n=a.renderThreadPhoto,o=a.renderThreadTitle;a=a.renderThreadSubtitle;var p=d!==void 0?d:function(a){},q=n!==void 0?n:function(a){return j.jsx(b("MWThreadPicture.bs").make,{photoSize:b("MWCMThreadTypes.bs").isAnyCMThread(a.threadType)||b("gkx")("571")?"s_48":"s_56",badgeSize:b("gkx")("571")?10:14,thread:a})},r=o!==void 0?o:function(a){return j.jsx(b("LSThreadTitle.bs").make,{thread:a})},s=a!==void 0?a:function(a){return j.jsx(b("MWThreadListLastMessage.bs").make,{hasOngoingCall:b("bs_caml").i64_neq(a.ongoingCallState,b("LSRtcCallState.bs").noOngoingCall),lastMessageTimestamp:b("bs_caml_int64").to_float(a.lastActivityTimestampMs),snippet:b("MWLSThreadSnippetForDisplay.bs").make(a),isUnread:b("MWPIsThreadUnread.bs").isThreadUnread(a),showTimestamp:!b("MWCMThreadTypes.bs").isUnjoinedCMThread(a.threadType)})};d=b("LSMessagingThreadTypeUtil.bs").isSecure(f.threadType);var t=d&&b("LSMessagingThreadTypeUtil.bs").isGroup(f.threadType),u=b("MWV2OpenTabOrThread.bs").useHook(void 0);n=j.useRef(null);o=j.useMemo(function(){return b("FBID.bs").ofStringExn(b("bs_int64").to_string(f.threadKey))},[f]);var v=b("MWLSJewelThreadSeenByImages.bs").useHook(f),w=b("useMatchMedia")("(min-width: 900px)")||!h,x=b("useReStore")();a=b("useGroupsCometCMOffboardingEntryPointDialog")(void 0);var y=a[0];h=b("ReQLSubscription.bs").useArray(j.useMemo(function(){return b("MWLSParticipant.bs").getAllInOpenThread(x,b("ReQL.bs").fromTableAscending(x.table("contacts")),f.threadKey)},[x,JSON.stringify(f.threadKey)]));a=b("MWLSGetLearningSpaceRoomOnThread.bs").useHook(f);a=a[2];var z=b("MWPActor.bs").useActor(void 0),A=b("MWPIsThreadUnread.bs").isThreadUnread(f),B=b("MWCMThreadTypes.bs").isUnjoinedCMThread(f.threadType),C=j.useMemo(function(){return b("MessengerMuteUtils.bs").calcMuteUntilMs(f)},[f]),D=f.snippetSenderContactId,E=D!==void 0?b("bs_caml").i64_eq(D,z):!1,F=b("MWChatCalculateIsMutedFromExpireTime.bs").useHook(C);D=b("useMenuButtonVisibilityState")(!0);var G=D[1],H=G.setMenuBtnFocused,I=G.setListItemHovered,J=b("MWCMThreadTypes.bs").isAnyCMThread(f.threadType),K=b("bs_caml").i64_eq(f.parentThreadKey,b("LsSystemFolder.bs").inbox),L=K?w:!B,M=j.useCallback(function(a){return b("bs_curry")._1(I,!1)},[I]),N=j.useCallback(b("bs_curry").__1(H),[H]),O=j.useCallback(function(a){return b("bs_curry")._1(I,!0)},[I]),P=v.map(function(a){return a.alt}),Q=P.length,R;if(Q!==1)R=Q!==0?g._(/*FBT_CALL*/{"*":"{=numPeople} \u0932\u094b\u0917\u094b\u0902 \u0926\u094d\u0935\u093e\u0930\u093e \u0926\u0947\u0916\u093e \u0917\u092f\u093e"}/*FBT_CALL*/,[g._param("=numPeople",P.length,[0])]):"";else{Q=P[0];R=g._(/*FBT_CALL*/"{=personName} \u0926\u094d\u0935\u093e\u0930\u093e \u0926\u0947\u0916\u093e \u0917\u092f\u093e"/*FBT_CALL*/,[g._param("=personName",Q)])}var S=b("MWUseLastMessageDeliveryStatusIcon.bs").useHook(f.threadKey,f.lastActivityTimestampMs,h,z);P=b("MWV2PreloadThread.bs").useHook(f.threadKey);var T=P[1],U=P[0];Q=b("bs_caml").i64_neq(f.ongoingCallState,b("LSRtcCallState.bs").noOngoingCall);var V=f.additionalThreadContext,W=j.useMemo(function(){if(V!==void 0)return j.jsxs(j.Fragment,{children:[j.jsx(b("MWText.react"),{color:"secondary",type:"meta4",numberOfLines:1,children:j.jsx(b("CometTextWithEntities.react"),{text:V,transforms:b("MWChatTextTransform.bs").epdTextTransforms}),testid:"eyebrowtext_message_request_v2"}),j.jsx(b("MWVerticalRhythm.bs").make,{height:8})]});else return null},[V]),X=b("MWCMUseFolder.bs").useHook(f);h=j.useMemo(function(){if(X!==void 0&&J)return[X.fbGroupId,X.enableState];else return[void 0,void 0]},[o]);z=h[0];var Y=b("bs_caml").i64_eq(b("bs_belt_Option").getWithDefault(h[1],b("CommunityMessagingEnableState.bs").enabled),b("CommunityMessagingEnableState.bs").disableRequested),aa=f.folderName==="inbox"?b("LsMessengerThreadDamagingActionsEntryPoint.bs").inboxThreadList:f.folderName==="pending"?b("LsMessengerThreadDamagingActionsEntryPoint.bs").pendingThreadList:b("LsMessengerThreadDamagingActionsEntryPoint.bs").spamThreadList,ba=b("UseBlockedUserInterstitial.bs").useHook(f.threadKey);P=b("MWLSThreadDisplayContext.bs").useHook(void 0);h=P!==void 0?P==="Inbox":!1;P=j.useContext(b("MessageRequestsBulkActionsContext.react"));P=P.isBulkActionsEditMode;var Z=b("MWCMUseShouldGoToFullScreenChat.bs").useHook(void 0),$=b("bs_belt_Option").getWithDefault(f.hasPendingInvitation,!1),ca=function(a){a=b("LSTransaction.bs").run(x,function(a){return b("LSUpdateCommunityChannelDirectInvite")(f.threadKey,b("FBGroupChatInviteState.bs").declinedByReceiver,b("LS.bs").make(a))},"readWrite");b("promiseDone")(a,void 0,void 0);b("cometPushToast").cometPushSimpleToast(g._(/*FBT_CALL*/"\u0906\u092a\u0928\u0947 \u091c\u0941\u0921\u093c\u0928\u0947 \u0915\u093e \u0906\u092e\u0902\u0924\u094d\u0930\u0923 \u0905\u0938\u094d\u0935\u0940\u0915\u093e\u0930 \u0915\u0930 \u0926\u093f\u092f\u093e"/*FBT_CALL*/).toString())};Z=j.jsx(b("CometEntryPointDialogTrigger.react"),{dialogEntryPoint:b("GroupsCometJoinChatDialog.entrypoint"),otherProps:{shouldGoToMessenger:Z,invited:$},preloadParams:{groupID:b("bs_int64").to_string(b("bs_belt_Option").getWithDefault(z,b("bs_caml_int64").zero)),threadID:b("bs_int64").to_string(f.threadKey)},fallback:function(a){return j.jsx(b("CometCardedDialogLoadingState.re").make,{})},children:function(a){var c,d=0;$?c=j.jsx(b("MWPThreadListItemInviteAddOn.react"),{onAccept:a,onDecline:ca}):w||!K?d=1:c=null;d===1&&(c=j.jsx(b("MWV2UseThreadAddOnSecondary.bs").make,{isUnread:A,isMuted:F,isViewerSender:E,seenByImages:v,lastMessageDeliveryStatusIcon:S,seenByScreenReaderText:R,isSecureGroupThread:t}));return j.jsx(b("MDSListCell.react"),{addOnStart:b("bs_curry")._1(q,f),addOnEnd:c,content:w||!K?j.jsxs(j.Fragment,{children:[W,j.jsx(b("MWText.react"),{color:"primary",type:A?b("gkx")("571")?"entityHeaderMeta1":"headlineEmphasized4":b("gkx")("571")?"headline4":"body3",numberOfLines:1,children:b("bs_curry")._1(r,f)}),j.jsx(b("MWVerticalRhythm.bs").make,{height:8}),b("bs_curry")._1(s,f)]}):null,selected:e,size:"large",onHoverIn:U,onHoverOut:T,onFocusChange:N,onPress:function(c){if(B)if(Y)return y({},function(a){});else return b("bs_curry")._1(a,void 0);else{var d=c.metaKey||c.ctrlKey||c.shiftKey;b("bs_curry")._2(ba,function(a){a=d?u.openInbox:b("bs_curry")._1(u.openTabOrInbox,!0);return b("bs_curry")._2(a,{threadKey:f.threadKey,clientThreadKey:f.clientThreadKey,threadType:f.threadType},m)},aa);return b("bs_curry")._1(p,void 0)}},linkProps:{preventLocalNavigation:!0,url:b("bs_curry")._1(u.getUrlFromThreadKey,f.threadKey)},"aria-current":e?"page":"false"})}},b("bs_int64").to_string(f.threadKey));if(L){if(P)L=null;else{D={hidden:!D[0],onFocusChange:H,onHoverChange:G.setMenuBtnHovered,onMenuStateChange:G.setMenuOpened,popoverResource:l,popoverProps:{fbid:o,isUnread:A,mutedUntil:C/1e3,onCloseJewel:p,messagingEntrypoint:c,thread:f,selected:e,groupId:b("bs_int64").to_string(b("bs_belt_Option").getWithDefault(z,b("bs_caml_int64").zero))},popoverTriggerType:"lazy",testid:"mwthreadlist-menu-id-"+o};H=b("gkx")("571")?32:void 0;H!==void 0&&(D.size=H);L=j.jsx(b("CometListCellHoverButton.react"),D)}G=j.jsx(b("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:j.jsxs("div",{role:"gridcell",children:[j.jsx(b("RTWebInboxJoinOngoingCallIcon.react"),{hasActiveRoom:a,hidden:!Q&&!a,ongoingCallType:b("RTCCallState.bs").ofLsRtcCallState(f.ongoingCallState,f.threadType),size:32}),L]})})}else G=null;C=j.jsx("div",{"data-testid":d?"mwthreadlist-item-secure":"mwthreadlist-item-open",children:j.jsx("div",{className:(i||(i=b("stylex")))(k.listItemContainer,b("gkx")("571")?k.listItemContainerForMessengerDotCom:!1),onMouseEnter:O,onMouseLeave:M,role:"row","data-testid":"mwthreadlist-item",children:j.jsxs(b("MWThreadListFocusableTable.react").MWThreadListFocusableTableRow,{children:[j.jsx(b("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:j.jsx("div",{role:"gridcell",ref:n,children:P?j.jsx(b("MessageRequestsBulkActionsThreadListItem.bs").make,{thread:f,threadListCell:Z}):Z})}),G]})})});if(h)return j.jsx(b("MWSelectedThreadOptionsIdContext.bs").make,{children:j.jsx(b("CometTransientDialogProvider.react"),{children:C}),threadId:f.threadKey});else return C}e=j.memo(a);f.RTWebInboxJoinOngoingCallIcon=c;f.MWPThreadListItemInviteAddOn=d;f.styles=k;f.$MWThreadListHoverButtonDropdownMenu$Deferred=l;f.make=e}),null);
__d("MWThreadListGlimmer.bs",["BaseGlimmer.react","react","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j={glimmerBody:{borderTopStartRadius:"ue3kfks5",borderTopEndRadius:"pw54ja7n",borderBottomEndRadius:"uo3d90p7",borderBottomStartRadius:"l82x9zwi",height:"cyypbtt7",width:"eq70wtua"},glimmerHeadline:{borderTopStartRadius:"ue3kfks5",borderTopEndRadius:"pw54ja7n",borderBottomEndRadius:"uo3d90p7",borderBottomStartRadius:"l82x9zwi",height:"gl3lb2sf",marginBottom:"oud54xpy",width:"n99xedck"},glimmerPhoto56:{borderTopStartRadius:"s45kfl79",borderTopEndRadius:"emlxlaya",borderBottomEndRadius:"bkmhp75w",borderBottomStartRadius:"spb7xbtv",height:"e5d9fub0",marginTop:"aov4n071",marginEnd:"wkznzc2l",marginBottom:"bi6gxh9e",marginStart:"hcukyx3x",width:"oeao4gh3"},glimmerRoot:{display:"j83agx80",paddingStart:"dati1w0a"},glimmerText:{display:"j83agx80",flexDirection:"cbu4d94t",flexGrow:"buofh1pr",justifyContent:"taijpn5t"}};function a(a){a=i.jsxs(i.Fragment,{children:[i.jsx(b("BaseGlimmer.react"),{className:(h||(h=b("stylex")))(j.glimmerPhoto56),index:0}),i.jsxs("div",{className:h(j.glimmerText),children:[i.jsx(b("BaseGlimmer.react"),{className:h(j.glimmerHeadline),index:1}),i.jsx(b("BaseGlimmer.react"),{className:h(j.glimmerBody),index:2})]})]});a={children:a,className:h(j.glimmerRoot)};return i.jsx("div",(a["data-testid"]="MWJewelThreadListGlimmer",a))}c=a;f.styles=j;f.make=c}),null);
__d("MWThreadListFolderItem.bs",["CometTextWithEntities.react","MWCMThreadTypes.bs","MWChatTextTransform.bs","MWPIsThreadUnread.bs","MWText.react","MWThreadListFocusableTable.react","MWThreadListLastMessage.bs","ReQL.bs","ReQLSubscription.bs","SortedAsyncIterable.bs","TetraListCell.react","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_option","bs_curry","react","useMatchMedia","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=a.size,d=a.thread,e=a.responsive,f=a.onClick,g=a.selectedThreadKey,i=a.systemFolder,j=a.icon,k=a.threadName;a=b("useMatchMedia")("(min-width: 900px)")||!e;var l=b("useReStore")();e=b("bs_belt_Option").isSome(b("ReQLSubscription.bs").useFirst(h.useMemo(function(){if(g!==void 0)return b("ReQL.bs").filter(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(l.table("threads")),{hd:g,tl:0}),function(a){return b("bs_caml").i64_eq(a.parentThreadKey,i)});else return b("SortedAsyncIterable.bs").empty(void 0)},[g,d])));var m=h.useMemo(function(){var a=d.snippet;if(a!==void 0)return a;else return null},[d]),n=b("bs_caml_int64").to_float(d.lastActivityTimestampMs),o=b("MWPIsThreadUnread.bs").isThreadUnread(d),p=d.threadName;c=h.useMemo(function(){return j},[c]);var q=h.useMemo(function(){return b("bs_belt_Option").getWithDefault(p,k)},[p]),r=h.useMemo(function(){return h.jsx(b("MWText.react"),{color:"primary",type:o?"headlineEmphasized4":"body3",numberOfLines:1,children:h.jsx(b("CometTextWithEntities.react"),{text:q.toString(),transforms:b("MWChatTextTransform.bs").epdTextTransforms})})},[o,q]),s=h.useCallback(function(a){return b("bs_curry")._1(f,void 0)},[f]);n={body:a?h.jsx(b("MWThreadListLastMessage.bs").make,{hasOngoingCall:!1,lastMessageTimestamp:n,snippet:m,isUnread:o,showTimestamp:!b("MWCMThreadTypes.bs").isUnjoinedCMThread(d.threadType)}):null,addOnPrimary:c,bodyLineLimit:1,emphasized:o,headlineLineLimit:1,level:4,onPress:s,selected:e};m=a?b("bs_caml_option").some(r):void 0;m!==void 0&&(n.headline=b("bs_caml_option").valFromOption(m));c=h.jsx(b("MWThreadListFocusableTable.react").MWThreadListFocusableTableRow,{children:h.jsx("div",{role:"row",children:h.jsx(b("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:h.jsx("div",{role:"gridcell",children:h.jsx(b("TetraListCell.react"),n)})})})});s={children:c};return h.jsx("div",(s["data-testid"]="mwthreadlist-item",s))}c=a;f.make=c}),null);
__d("MWThreadListJobsItem.bs",["fbt","ix","LsSystemFolder.bs","MWThreadListFolderItem.bs","bs_curry","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||b("react");function a(a){var c=a.size,d=a.thread,e=a.responsive,f=a.onClick;a=a.selectedThreadKey;var i=function(a){return b("bs_curry")._1(f,b("LsSystemFolder.bs").jobs)};return j.jsx(b("MWThreadListFolderItem.bs").make,{size:c,thread:d,responsive:e,onClick:i,selectedThreadKey:a,systemFolder:b("LsSystemFolder.bs").jobs,icon:{color:"gray",size:56,disabled:!1,shape:"circle",icon:b("fbicon")._(h("512668"),32),type:"contained-icon"},threadName:g._(/*FBT_CALL*/"\u091c\u0949\u092c\u094d\u0938"/*FBT_CALL*/)})}c=a;f.make=c}),null);
__d("MWV2ThreadListItem.bs",["InteractionTracingMetrics","LSMessagingThreadTypeUtil.bs","MWPThreadListItem.bs","bs_curry","react","useSimpleImpression"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){b("useSimpleImpression")(a)}function c(a){var c=a.messagingEntrypoint,d=a.onClose,e=a.selected,f=a.size,g=a.thread,i=a.responsive;a=a.lsEntryPoint;d=d!==void 0?d:function(a){};b("useSimpleImpression")(function(a){a=b("LSMessagingThreadTypeUtil.bs").isSecure(g.threadType);var c=b("InteractionTracingMetrics").currentInteractionLogger();return b("bs_curry")._2(c.addMetadata,"hasSecureThread",a?1:0)});return h.jsx(b("MWPThreadListItem.bs").make,{messagingEntrypoint:c,onClose:d,selected:e,size:f,thread:g,responsive:i,lsEntryPoint:a})}d=c;f.useSimpleImpression=a;f.make=d}),null);
__d("MWThreadList.bs",["CometPlaceholder.react","FBID.bs","FocusRegion.react","LSMessagingThreadTypeUtil.bs","LsSystemFolder.bs","MWBaseThreadList.bs","MWIsXacGroupThread.bs","MWLSJewelMessageRequestsThread.bs","MWPBumpEntityKey.bs","MWPThreadsForThreadList.bs","MWThreadKey.bs","MWThreadListGlimmer.bs","MWThreadListJobsItem.bs","MWThreadListSupportedThreadTypes.bs","MWThread_DEPRECATED.bs","MWV2ThreadIsPage.bs","MWV2ThreadListItem.bs","MWXacGating.bs","MessagingThreadType.bs","MessengerWebEntryPoint","ReQL.bs","ReQLSuspense","bs_belt_Option","bs_caml","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","cr:12211","cr:1913","cr:9873","react","recoverableViolation","useCometUniqueID","useReStore","useSimpleImpression"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=b("cr:1913")==null?void 0:b("bs_caml_option").some(b("cr:1913"));e=b("cr:12211")==null?void 0:b("bs_caml_option").some(b("cr:12211"));function a(a){b("useSimpleImpression")(a)}function j(a){h.useEffect(function(){b("recoverableViolation")("Unknown thread type","comet_messenger")},[]);return null}var k={make:j};function l(a){var c=b("FBID.bs").ofStringExn(b("bs_int64").to_string(a.threadKey)),d=a.threadType;a=a.cannotUnsendReason;if(a!==void 0&&b("bs_caml").i64_eq(d,b("MessagingThreadType.bs").oneToOne)&&b("bs_caml").i64_eq(a,[0,4]))return{NAME:"Page",VAL:c};if(b("LSMessagingThreadTypeUtil.bs").isOneToOne(d))return{NAME:"User",VAL:c};else if(b("LSMessagingThreadTypeUtil.bs").isGroup(d))return{NAME:"Group",VAL:c};else return}function c(a){var c=a.thread,d=a.messagingEntrypoint,e=a.lsEntryPoint,f=a.onClose,g=a.responsive,k=a.onClickNestedFolderThread;a=a.selectedThreadKey;if(b("bs_caml").i64_eq(c.threadType,b("MessagingThreadType.bs").folder)){var m=c.threadKey;if(b("bs_caml").i64_eq(m,b("LsSystemFolder.bs").mplace))if(b("cr:1913")==null)return null;else return h.jsx(i.make,{size:56,thread:c,responsive:g,onClick:k,selectedThreadKey:a});else if(b("bs_caml").i64_eq(m,b("LsSystemFolder.bs").jobs))return h.jsx(b("MWThreadListJobsItem.bs").make,{size:56,thread:c,responsive:g,onClick:k,selectedThreadKey:a});else return null}m=l(c);if(m!==void 0)return h.jsx(b("MWThread_DEPRECATED.bs").make,{id:m,children:h.jsx(b("CometPlaceholder.react"),{children:h.jsx(b("MWV2ThreadIsPage.bs").make,{thread:c,children:h.jsx(b("MWThreadKey.bs").make,{id:c.threadKey,children:h.jsx(b("MWV2ThreadListItem.bs").make,{messagingEntrypoint:d,onClose:f,selected:b("bs_caml_obj").caml_equal(a,c.threadKey),size:56,thread:c,responsive:g,lsEntryPoint:e})})}),fallback:h.jsx(b("MWThreadListGlimmer.bs").make,{})})});else return h.jsx(j,{})}var m=h.memo(c);c={make:m};var n=b("cr:12211")==null?function(a){}:e.useHook;function d(a){var c=a.parentThreadKey,d=a.header,e=a.onOpenMessageRequests,f=a.threadListMessagingEntrypoint,g=a.selectedThreadKey,i=a.onClose,j=a.responsive,k=a.preamble,l=a.lsEntryPoint,o=a.onClickNestedFolderThread;a=a.gridLabel;var p=i!==void 0?i:function(a){};i=k!==void 0?b("bs_caml_option").valFromOption(k):null;var q=o!==void 0?o:function(a){},r=b("useReStore")(),s=b("ReQLSuspense").useFirst(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(r.table("threads_ranges_v2__generated")),{hd:c,tl:0})},[r,c]);k=b("ReQLSuspense").useArray(function(){return b("ReQL.bs").take(b("ReQL.bs").filter(b("ReQL.bs").filter(b("MWPThreadsForThreadList.bs").createIterable(r,c,s),function(a){return b("MWThreadListSupportedThreadTypes.bs").supportedThreadTypes.findIndex(function(c){return b("bs_caml").i64_eq(a.threadType,c)})!==-1}),function(a){if(b("MWXacGating.bs").isGroupsEnabled(void 0))return!0;else return!b("MWIsXacGroupThread.bs").check(a)}),5)},[r,JSON.stringify(c),s]).pop();var t=k===void 0?void 0:b("bs_caml_option").some(k);o=d!==void 0?h.jsx(b("FocusRegion.react").FocusRegion,{children:b("bs_caml_option").valFromOption(d)}):null;k=b("useCometUniqueID")();b("bs_curry")._1(n,k);d=b("MWLSJewelMessageRequestsThread.bs").useHook(e);e=h.useCallback(function(a){return h.jsx(m,{thread:a,messagingEntrypoint:b("bs_belt_Option").getWithDefault(f,b("MessengerWebEntryPoint").JEWEL),lsEntryPoint:l==="inboxThreadList"&&b("bs_belt_Option").mapWithDefault(t,!1,function(c){return b("bs_caml").i64_le(a.lastActivityTimestampMs,c.lastActivityTimestampMs)})?"inboxRecentThreads":l==="inboxThreadList"&&b("bs_belt_Option").mapWithDefault(t,!1,function(c){return b("bs_caml").i64_gt(a.lastActivityTimestampMs,c.lastActivityTimestampMs)})?"inboxRemainingThreads":l,onClose:p,responsive:j,onClickNestedFolderThread:q,selectedThreadKey:g})},[j,f,l,p,q,g,t]);return h.jsx("div",{id:k,children:h.jsx(b("MWBaseThreadList.bs").make,{parentThreadKey:c,beforeContent:h.jsxs(h.Fragment,{children:[o,d,i]}),gridLabel:a,renderItem:e,onLoadMoreThreads:function(a){return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw.threadlist","load_more_threads")},itemPlaceholder:h.jsxs(h.Fragment,{children:[h.jsx(b("MWThreadListGlimmer.bs").make,{}),h.jsx(b("MWThreadListGlimmer.bs").make,{})]})})})}e=56;d=d;f.$MAWThreadId$requireCond=b("cr:9873");f.$MWUseKeyCommandsForThreadList$OR$null$requireCond=b("cr:12211");f.$null$OR$MWThreadListMarketplaceItem$requireCond=b("cr:1913");f.useSimpleImpression=a;f.threadlistItemHeight=e;f.UnknownThreadType=k;f.ThreadListItemMemoized=c;f.useKeyCommandsForThreadList=n;f.make=d}),null);
__d("MWThreadListMarketplaceItem.bs",["fbt","ix","LsSystemFolder.bs","MWPBumpEntityKey.bs","MWThreadListFolderItem.bs","bs_curry","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||b("react");function a(a){var c=a.size,d=a.thread,e=a.responsive,f=a.onClick;a=a.selectedThreadKey;return j.jsx(b("MWThreadListFolderItem.bs").make,{size:c,thread:d,responsive:e,onClick:function(a){b("bs_curry")._1(f,b("LsSystemFolder.bs").mplace);return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw.sidebar","marketplace_threads")},selectedThreadKey:a,systemFolder:b("LsSystemFolder.bs").mplace,icon:{color:"gray",size:56,disabled:!1,shape:"circle",icon:b("fbicon")._(h("1027308"),32),type:"contained-icon"},threadName:g._(/*FBT_CALL*/"Marketplace"/*FBT_CALL*/)})}c=a;f.make=c}),null);
__d("MWLSThreadDisplayContext.re",["MWLSThreadDisplayContext.bs"],(function(a,b,c,d,e,f){a=b("MWLSThreadDisplayContext.bs").Provider.make;f.Provider_make=a;c=b("MWLSThreadDisplayContext.bs").useHook;f.useHook=c;d=b("MWLSThreadDisplayContext.bs").Provider;f.Provider=d}),null);
__d("LSDataTraceFlushDeferred.bs",["bs_curry","killswitch","requireDeferred"],(function(a,b,c,d,e,f){"use strict";var g=b("requireDeferred")("LSDataTraceFlush.bs").__setRef("LSDataTraceFlushDeferred.bs");function a(a){if(!b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID")){g.onReady(function(c){return b("bs_curry")._1(c.flushExpiredDataTraces,a)});return}}f.$LSDataTraceFlush$Deferred=g;f.watchForExpiredTraces=a}),null);
__d("LSClearEpochBeforeResumeSync.bs",["LSTransaction.bs","Promise","ReQL.bs","gkx","killswitch"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174"))return b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){var c=b[1];b=b[0].currentCursor;if(b!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return window.Promise.resolve(void 0)}))}).then(function(c){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""})).then(function(c){return b("Promise").all(c.map(function(b){return a.table("network_requests").put({taskQueueName:b.taskQueueName,syncDatabaseId:b.syncDatabaseId,epochId:void 0,networkTaskIdentifier:b.networkTaskIdentifier,lastSentTimestampMs:b.lastSentTimestampMs,failureCount:b.failureCount,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs})}))})})},"readWrite").then(function(a){return b("Promise").resolve(void 0)});else return b("Promise").resolve(void 0)}f.call=a}),null);
__d("LSPlatformDevtoolsHelpers.bs",["CometDevToolsLightspeedEvents.bs","LSDict","bs_curry","bs_int64","cr:1489419"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sending",queueName:a.queue_name,payload:a.payload,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),startTime:Date.now()}})])}function c(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").armadilloBridge,a])}function d(a,c){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sent",queueName:a.queue_name,response:c,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),endTime:Date.now()}})])}function e(a){if(!(b("cr:1489419")==null)){b("bs_curry")._1(b("cr:1489419").registerStorage,a);return}}function g(a){if(b("cr:1489419")==null)return a;else return b("bs_curry")._1(b("cr:1489419").registerDatascriptExec,a)}f.$CometDevToolsLightspeedInterop$OR$null$requireCond=b("cr:1489419");f.recordTaskSending=a;f.recordBridgeUIEvent=c;f.recordTaskSent=d;f.registerDb=e;f.$CometDevToolsLightspeedInterop$requireCond=b("cr:1489419");f.evalWithDevtoolSupport=g}),null);
__d("LSPlatformGraphQLTransport.bs",["FBLogger","LSDynamicDependencies","LSLogHistory.bs","Promise","Promise.bs","bs_belt_Option","bs_caml_exceptions","bs_caml_int64","bs_caml_option","bs_int64"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_exceptions").create("LSPlatformGraphQLTransport.ServerError");function a(a,c,d,e,f){return b("Promise.bs").$$catch(f(a,c,e,b("bs_caml_int64").to_int32(d)),function(a){if(a.RE_EXN_ID===b("Promise.bs").JsError){a=a._1;var c=a.message;b("LSLogHistory.bs").log("Error sending Graphql Request. Type: "+b("bs_int64").to_string(d)+" Message: "+(c!==void 0?c:"None"),"error");b("FBLogger")("messenger_web_product").catching(a).debug("Relay or Graphql Server error in LSPlatformGraphqlTransport")}throw{RE_EXN_ID:g,Error:new Error()}}).then(function(c){c=b("bs_belt_Option").getExn(c==null?void 0:b("bs_caml_option").some(c));var a=b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(c.payload)),d=c.dependencies;d=d==null?b("Promise").resolve(void 0):b("LSDynamicDependencies").downloadRelayDependencies(d);return[d,a,b("bs_caml_option").nullable_to_opt(c.experiments)]})}f.ServerError=g;f.publish=a}),null);
__d("LSPlatformHardcodedInitSync.bs",["IntlCurrentLocale","LSDatabaseType.bs","LSDict","LSJson","LSPlatformGraphQLTransport.bs","LSRequestType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","QPLUserFlow","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","qpl","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=(c=b("bs_caml_int64")).zero;function h(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").mailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:(c=b("bs_caml_int64")).zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").contact,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0})])},"readWrite").then(function(a){return b("Promise").resolve(void 0)})}function i(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([(c=b("ReQL.bs")).first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").mailbox,tl:0}})),c.first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").contact,tl:0}}))]).then(function(c){var d=c[1];c=c[0];if(c!==void 0&&d!==void 0)return b("Promise").all([a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:g,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs}),a.table("network_requests").put({taskQueueName:d.taskQueueName,syncDatabaseId:d.syncDatabaseId,epochId:g,networkTaskIdentifier:d.networkTaskIdentifier,lastSentTimestampMs:d.lastSentTimestampMs,failureCount:d.failureCount,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs})]).then(function(a){});else return b("Promise").resolve(void 0)})},"readWrite")}function a(a,c,d){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_graphql","init_sync.success");b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.success");b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"initial_sync_received",void 0);return i(d).then(function(e){return b("Promise.bs").$$catch(b("Promise").all([(e=b("ReQL.bs")).first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").mailbox,tl:0})),e.first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").contact,tl:0}))]).then(function(c){var d,e=(d=b("bs_belt_Option")).mapWithDefault(c[0],void 0,function(a){return a.currentCursor});c=d.mapWithDefault(c[1],void 0,function(a){return a.currentCursor});var f=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").mailbox).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({scale:1,preview_height:200,preview_width:a.previewWidth,preview_height_large:400,preview_width_large:a.previewWidthLarge,full_height:200,snapshot_num_threads_per_page:a.numThreads,locale:b("IntlCurrentLocale").code}))).set("epoch_id",g).set("last_applied_cursor",e);d=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").contact).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({locale:b("IntlCurrentLocale").code}))).set("epoch_id",g).set("last_applied_cursor",c);return b("Promise").all([b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,0,b("bs_belt_Option").isSome(e)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(f),a.executeGraphQLLightSpeedRequest),b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,1,b("bs_belt_Option").isSome(c)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(d),a.executeGraphQLLightSpeedRequest)])}).then(function(a){var d=a[1],e=d[2],f=d[1];a=a[0];var g=a[2],h=a[1];return b("Promise").all([a[0],d[0]]).then(function(a){return b("bs_curry")._1(c,{experiments:g,syncScript:h})}).then(function(a){return b("bs_curry")._1(c,{experiments:e,syncScript:f})})}).then(function(a){b("QPLUserFlow").endSuccess(b("qpl")._(25305590,"1127"),"success_with_init_sync")}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.fail");b("QPLUserFlow").endFailure(b("qpl")._(25305590,"1127"),"failure_during_init_sync",void 0);a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError||a.RE_EXN_ID!==b("Promise.bs").JsError||b("recoverableViolation")("Encountered an error while performining preloaded init sync request via graphql","messenger_web_product",{error:b("bs_caml_option").some(a._1)});return h(d)})})}d={taskQueueName:"",syncDatabaseId:c.zero,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0};f.defaultNetworkRequest=d;f.initialEpochId=g;f.handlePreloadedSyncFailure=h;f.setEpochId=i;f.sendHardcodedInitSync=a}),null);
__d("LSPlatformRequestId.bs",[],(function(a,b,c,d,e,f){"use strict";var g={contents:2};function a(a){a=g.contents;g.contents=g.contents+1|0;return a}f.generate=a}),null);
__d("LSPlatformRequestScheduler.bs",["bs_curry","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";function a(a){return new Map()}function c(a,c,d,e){var f=a.get(d);f==null||b("clearTimeout")(f);f=b("setTimeout")(function(a){return b("bs_curry")._1(c,void 0)},e);a.set(d,f)}f.make=a;f.schedule=c}),null);
__d("LSPlatformServerResponseHandler",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.eval=a,this.currentlyRunning=b("Promise").resolve()}var c=a.prototype;c.evalWhenReady=function(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(a);case 2:d.next=4;return b("regeneratorRuntime").awrap(this.eval(c));case 4:case"end":return d.stop()}},null,this)};c.evalInOrderReceived=function(a,b){var c=this,d=this.currentlyRunning.then(function(){return c.evalWhenReady(a,b)});this.currentlyRunning=d;return d};return a}();f["default"]=a}),66);
__d("LSTaskWorkItemType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];f.workItemTypeSendToServer=a;f.workItemTypeHandleNative=c;f.workItemTypeDelayHandling=d;f.workItemTypeNone=e;f.workItemTypeSendToServerFireAndForget=b}),null);
__d("LSPlatformSyncSystem.bs",["LS.bs","LSBeginHandlingSync","LSBeginHandlingSyncForSyncGroup","LSCookie.bs","LSDict","LSJson","LSLogHistory.bs","LSPlatformGraphQLTransport.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId.bs","LSPlatformRequestScheduler.bs","LSPlatformServerResponseHandler","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","bs_js_dict","gkx","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g){var h=new(b("LSPlatformServerResponseHandler"))(d),i=function(a,c){return b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:c,tl:0}})).then(function(c){if(c!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:b("bs_caml_int64").add(c.failureCount,b("bs_caml_int64").one),lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return b("Promise").resolve(void 0)})},"readWrite")},j=b("LSPlatformRequestScheduler.bs").make(void 0),k=function(a,h,i){i=b("LSDict").shapeToRecord(i);var j=b("LSDict").shapeToRecord(i.request_payload),k=i.type,l=b("LSPlatformRequestId.bs").generate(void 0),m=b("LSJson").stringify(b("LSDict").fromObject({database:j.database,version:b("bs_caml_format").caml_int64_of_string(e),epoch_id:j.epoch_id,last_applied_cursor:j.last_applied_cursor,failure_count:j.failure_count,sync_params:j.sync_params}));if(h.skip_realtime_gateway)return b("LSPlatformGraphQLTransport.bs").publish(f,l,k,m,g).then(function(a){return b("bs_curry")._1(d,{experiments:a[2],syncScript:a[1]}).then(function(a){return b("Promise").resolve(void 0)})});else return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),{hd:h.sync_group_id,tl:0})).then(function(a){a=a!==void 0?a.syncChannel:b("LSSyncChannel.bs").mqtt;return b("bs_curry")._5(c.publish,a,void 0,l,k,m).then(function(a){return b("Promise").resolve(void 0)})})},l=function a(c,d){var e=function(d){return b("LSTransaction.bs").run(c,function(a){return b("LSBeginHandlingSyncForSyncGroup")(d,!1,b("LS.bs").make(a))},"readWrite").then(function(b){return a(c,b[0])})},f=function(a,c){return b("LSPlatformRequestScheduler.bs").schedule(j,function(c){b("promiseDone")(e(a),void 0,void 0)},b("bs_int64").to_string(a),b("bs_caml_int64").to_float(c))},g=b("LSDict").shapeToRecord(d);d=g.work_item_type;if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)||b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget)){var h=g.network_payload;if(h!==void 0)return b("Promise.bs").$$catch(k(c,g,b("bs_caml_option").valFromOption(h)),function(a){a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error"):a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_js_error"),b("recoverableViolation")("Encountered an JS error while publishing a LS sync request","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"):(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error"),b("recoverableViolation")("Encountered an error while publishing a LS sync request with non JS error error","messenger_web_product"));return i(c,g.sync_group_id).then(function(a){return e(g.sync_group_id)})});else{b("recoverableViolation")("Expected networkpayload for sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}}if(!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling))if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeNone)||!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeHandleNative))return b("Promise").resolve(void 0);else{b("recoverableViolation")("Native handling for sync group not implemented yet","messenger_web_product");return b("Promise").resolve(void 0)}h=g.next_sync_ms;if(h!==void 0){f(g.sync_group_id,h);return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Expected delay for delayed sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}},m=function(c){return b("Promise").all(c[0].map(function(b){return l(a,b)}))},n=function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))},"readWrite").then(m),void 0,void 0)},o=function(){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,b){return n()})},p=function(){return c.subscribeToNonTaskResponses(function(a,c){var e=c.ex;c=c.payload;e={experiments:e,syncScript:c};b("promiseDone")(b("gkx")("4463")?h.evalInOrderReceived(a,e):b("bs_curry")._1(d,e),function(a){return n()},function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure"),a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Error encountered handling response from MQTT","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Error encountered handling response from MQTT with unknown error","messenger_web_product")})})},q=function(a){var c=b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,c){a=a.hd;var d=b("LSCookie.bs").get(void 0),e=d.c,f,g;if(typeof c==="number")f=1;else if(c.TAG===0){var h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}else{h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}switch(f){case 1:if(!b("bs_belt_Option").isSome(b("bs_js_dict").get(e,b("bs_int64").to_string(a))))return;b("bs_js_dict").unsafeDeleteKey(e,b("bs_int64").to_string(a));c=b("LSCookie.bs").writeCookie(d);b("promiseDone")(c,void 0,void 0);return;case 2:if(!b("bs_caml_obj").caml_notequal(b("bs_js_dict").get(e,b("bs_int64").to_string(a)),g))return;e[b("bs_int64").to_string(a)]=g;h=b("LSCookie.bs").writeCookie(d);b("promiseDone")(h,void 0,void 0);return}});return function(a){return b("bs_curry")._1(c,void 0)}},r=function(){return c.onReconnect(function(){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect"),b("LSLogHistory.bs").log("LS Sync System reconnecting","debug"),b("promiseDone")(b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){var c=b[1];b=b[0].currentCursor;if(b!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return window.Promise.resolve(void 0)}))}).then(function(c){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))})},"readWrite").then(m),void 0,void 0)})},s=o(),t=p(),u=r(),v=!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")?q(a):function(a){};n();return{cleanup:function(){var a;(a=b("bs_curry"))._1(s,void 0);a._1(u,void 0);a._1(t,void 0);return a._1(v,void 0)}}}f.make=a}),null);
__d("LSPlatformTraceTasks",["LS.re","LSGenerateTraceId","LSPredefineTraceForTask","gkx","justknobx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set();c("gkx")("4729")&&h.add("207");function a(a,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!c("justknobx")._("506")){k.next=12;break}f=0;case 2:if(!(f<e.length)){k.next=12;break}g=e[f];if(!((g.dataTraceId==null||g.dataTraceId==="")&&h.has(g.context))){k.next=9;break}i=c("LSGenerateTraceId")();if(!(i!=null)){k.next=9;break}k.next=9;return b("regeneratorRuntime").awrap(c("LSPredefineTraceForTask")(i,g.taskId,(j=g.context)!=null?j:"","",d("LS.re").make(a)));case 9:f++;k.next=2;break;case 12:case"end":return k.stop()}},null,this)}e={startTraceForTaskIfEligible:a};g["default"]=e}),98);
__d("LSPlatformTaskSystem.bs",["LS.bs","LSBeginHandlingPendingTasks","LSBeginHandlingPendingTasksForQueue","LSDict","LSHandleTaskSendFailureForQueue","LSHandleTaskSendSuccessForQueue","LSJson","LSPlatformDevtoolsHelpers.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId.bs","LSPlatformRequestScheduler.bs","LSPlatformServerResponseHandler","LSPlatformTraceTasks","LSRequestType.bs","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Array","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){var f=[],g=b("LSPlatformRequestScheduler.bs").make(void 0),h=function(c){c=b("bs_belt_Option").map(c.network_payload,function(a){return b("LSDict").shapeToRecord(a)});if(c!==void 0)return b("bs_belt_Option").mapWithDefault(b("bs_belt_Array").get(c.tasks,0),b("Promise").resolve(void 0),function(c){c=b("LSDict").shapeToRecord(c).task_id;return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("pending_tasks")),{hd:c,tl:0})).then(function(a){return b("Promise").resolve(a!==void 0?a.dataTraceId:void 0)})});else return b("Promise").resolve(void 0)},i=function(c){return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendFailureForQueue")(c,b("LS.bs").make(a))},"readWrite")},j=new(b("LSPlatformServerResponseHandler"))(d),k=function f(k){var l=function(c,d){return b("LSPlatformRequestScheduler.bs").schedule(g,function(d){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingPendingTasksForQueue")(c,!1,b("LS.bs").make(a))},"readWrite").then(function(a){return f(b("LSDict").shapeToRecord(a[0]))}),void 0,void 0)},c,b("bs_caml_int64").to_float(d))},m=b("LSPlatformRequestId.bs").generate(void 0),n=b("bs_belt_Option").map(k.network_payload,function(a){return b("LSDict").shapeToRecord(a)}),o=k.work_item_type;if(n!==void 0){if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)){var p=n.epoch_id,q=n.tasks,r=k.queue_name;b("LSPlatformDevtoolsHelpers.bs").recordTaskSending(q);return b("Promise.bs").$$catch(h(k).then(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,r,m,b("LSRequestType.bs").taskBatch,b("LSJson").stringify(b("LSDict").fromObject({version_id:e,tasks:q,epoch_id:p,data_trace_id:a})))}).then(function(c){if(c){var e=c._1,f=e.ex,g=e.payload;f={experiments:f,syncScript:g};return b("Promise.bs").$$catch((b("gkx")("4463")?j.evalWhenReady(c._0,f):b("bs_curry")._1(d,f)).then(function(c){b("LSPlatformDevtoolsHelpers.bs").recordTaskSent(q,e.payload);return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendSuccessForQueue")(r,b("LS.bs").make(a))},"readWrite")}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure");a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:a});return i(r)})}b("recoverableViolation")("Expected a response for a non fire forget task","messenger_web_product");return b("Promise").resolve(void 0)}),function(a){a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected||(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:a}));return i(r)})}if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget))return b("Promise.bs").$$catch(b("Promise").all(n.tasks.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,void 0,m,b("LSRequestType.bs").fireForget,b("LSJson").stringify(b("LSDict").fromObject({label:a.label,payload:a.payload,version:e})))})).then(function(a){return b("Promise").resolve(void 0)}),function(a){return b("Promise").resolve(void 0)})}if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling)){l(k.queue_name,k.next_sync_ms);return b("Promise").resolve(void 0)}else if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeNone))return b("Promise").resolve(void 0);else if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeHandleNative)){b("recoverableViolation")("Native tasks not supported so far","messenger_web_product");return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Unknown Task type of "+b("bs_int64").to_string(o),"messenger_web_product");return b("Promise").resolve(void 0)}},l=function(c){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return(c.length>0?b("Promise.bs").$$catch(b("LSPlatformTraceTasks").startTraceForTaskIfEligible(a,c),function(a){return b("Promise").resolve(void 0)}):b("Promise").resolve(void 0)).then(function(c){return b("LSBeginHandlingPendingTasks")(!1,b("LS.bs").make(a))})},"readWrite").then(function(a){return b("Promise").all(a[0].map(function(a){return b("LSDict").shapeToRecord(a)}).map(k))}),void 0,void 0)},m=function(){var c,d={contents:!1},e={contents:[]},g=b("SortedAsyncIterable.bs").subscribe((c=b("ReQL.bs")).fromTableAscending(a.table("pending_tasks")),function(a,c){d.contents=!0;if(typeof c==="number")return;if(c.TAG===0)a=c._0;else{c=c._0;if(b("bs_caml").i64_gt(c.failureCount,b("bs_caml_int64").one))return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","tasks_failure_count_gt_one");a=c}if(a.dataTraceId===void 0||b("bs_caml_obj").caml_equal(a.dataTraceId,"")){e.contents.push(a);return}}),h=b("SortedAsyncIterable.bs").subscribe(c.fromTableAscending(a.table("pending_fire_and_forget_tasks")),function(a,b){return l(f)}),i=b("SortedAsyncIterable.bs").subscribe(c.filter(c.fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""}),function(a,c){if(typeof c==="number"){d.contents=!0;return}else if(c.TAG===0||!b("bs_caml").i64_gt(c._0.failureCount,b("bs_caml_int64").one))return;else return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","network_failure_count_gt_one")}),j=a.subscribeToCommit(function(a){if(!d.contents)return;a=e.contents;e.contents=[];d.contents=!1;return l(a)});return function(){var a;(a=b("bs_curry"))._1(g,void 0);a._1(h,void 0);a._1(i,void 0);return a._1(j,void 0)}},n=function(){return c.onReconnect(function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").toArray(b("ReQL.bs").bounds(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{NAME:"greaterThan",VAL:{hd:"",tl:0}})).then(function(c){return b("Promise").all(c.map(function(c){return b("LSHandleTaskSendFailureForQueue")(c.taskQueueName,b("LS.bs").make(a))}))})},"readWrite"),void 0,void 0)})},o=m(),p=n();l(f);return{cleanup:function(){o();return b("bs_curry")._1(p,void 0)}}}f.make=a}),null);
__d("LSPlatformClient.bs",["ExecutionEnvironment","LSClearEpochBeforeResumeSync.bs","LSDataTraceFlushDeferred.bs","LSJSInMemoryStorage.bs","LSMetadata","LSPlatformDevtoolsHelpers.bs","LSPlatformHardcodedInitSync.bs","LSPlatformRealtimeTransport.bs","LSPlatformSyncSystem.bs","LSPlatformTaskSystem.bs","Promise","bs_curry","cr:3238"],(function(a,b,c,d,e,f){"use strict";function a(a){var c={contents:0};if(b("ExecutionEnvironment").canUseDOM)return a.getDb().then(function(d){return b("bs_curry")._1(a.getEval,void 0).then(function(e){b("LSPlatformDevtoolsHelpers.bs").registerDb(d);var f=b("bs_curry")._2(b("LSPlatformDevtoolsHelpers.bs").evalWithDevtoolSupport(e),void 0,d);return b("LSClearEpochBeforeResumeSync.bs").call(d).then(function(c){if(a.sendHardcodedInitSync)return b("LSPlatformHardcodedInitSync.bs").sendHardcodedInitSync(a,f,d);else return b("Promise").resolve(void 0)}).then(function(e){e=function(e){e=c.contents;if(typeof e!=="number")return b("Promise").resolve(void 0);e=c.contents===1?b("LSClearEpochBeforeResumeSync.bs").call(d):b("Promise").resolve(void 0);return e.then(function(e){var g=b("LSPlatformRealtimeTransport.bs").make(a.realtimeUnderylingTransport,a.appId),h=b("LSPlatformTaskSystem.bs").make(d,g,f,a.schemaVersion),i=b("LSPlatformSyncSystem.bs").make(d,g,f,a.schemaVersion,a.deviceId,a.executeGraphQLLightSpeedRequest);e=function(a){h.cleanup(),i.cleanup(),g.cleanup(),c.contents=1};c.contents={_0:e,_1:g.onConnectionStatusChange}})};return b("Promise").resolve({start:e,cleanup:function(a){a=c.contents;if(typeof a==="number")return;else return b("bs_curry")._1(a._0,void 0)},db:d,onConnectionStatusChange:function(a){var b=c.contents;if(typeof b==="number")return function(a){};else return b._1(a)}})})})}).then(function(a){b("LSDataTraceFlushDeferred.bs").watchForExpiredTraces(a.db);b("cr:3238")==null||b("bs_curry")._1(b("cr:3238").listenForChangesToBackupState,a.db);return a});else return b("Promise").resolve({start:function(a){return b("Promise").resolve(void 0)},cleanup:function(a){},db:b("LSJSInMemoryStorage.bs").make(b("LSMetadata").metadata),onConnectionStatusChange:function(a){return function(a){}}})}f.$MWEncryptedBackupsListenForChangesToBackupStateInitPath$requireCond=b("cr:3238");f.make=a}),null);
__d("MWLSUseSyncRankings.bs",["LSDatabaseType.bs","MWLSDatabaseLazySync.bs","promiseDone"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("MWLSDatabaseLazySync.bs").useSync(b("LSDatabaseType.bs").ranking)}var g={contents:!1};function c(a){if(g.contents)return;g.contents=!0;a=b("MWLSDatabaseLazySync.bs").sync(a,b("LSDatabaseType.bs").ranking);b("promiseDone")(a,void 0,void 0)}f.useHook=a;f.rankingSyncStarted=g;f.sync=c}),null);
__d("MWPSearchIndexingSource.bs",["MessagingThreadType.bs","ReQL.bs","ReQLSuspense","SortedAsyncIterable.bs","bs_caml","bs_curry"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("ReQL.bs").toArray(b("ReQL.bs").fromTableAscending(a.table("contacts")))}function c(a,c){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("contacts")),function(a,d){return b("bs_curry")._2(c,a.hd,d)})}function d(a){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("threads")),function(a){return b("bs_caml").i64_eq(a.threadType,b("MessagingThreadType.bs").group)}))}function e(a,c){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("threads")),function(a){return b("bs_caml").i64_eq(a.threadType,b("MessagingThreadType.bs").group)}),function(a,d){return b("bs_curry")._2(c,a.hd,d)})}function g(a){return b("ReQL.bs").toArray(b("ReQL.bs").map(b("ReQL.bs").fromTableAscending(a.table("participants")),function(c){return[c,b("ReQLSuspense").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:c.contactId,tl:0}))]}))}function h(a,c){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("participants")),function(a,d){return b("bs_curry")._3(c,a.hd,a.tl.hd,d)})}f.fetchContacts=a;f.subToContacts=c;f.fetchGroupThreads=d;f.subToGroupThreads=e;f.fetchGroupParticipants=g;f.subToGroupParticipants=h}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("minisearch-3.0.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g},i;function j(){(function(b,c){typeof g==="object"&&typeof h!=="undefined"?h.exports=c():typeof i==="function"&&i.amd?i(c):(b=typeof globalThis!=="undefined"?globalThis:b||self,b.MiniSearch=c())})(this,function(){var a=function(){a=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return a.apply(this,arguments)};function b(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{while((b===void 0||b-->0)&&!(d=a.next()).done)e.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error}}return e}function d(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(c(arguments[b]));return a}var e="ENTRIES",f="KEYS",g="VALUES",h="",i=function(){function a(a,b){var c=a._tree,d=Object.keys(c);this.set=a;this._type=b;this._path=d.length>0?[{node:c,keys:d}]:[]}a.prototype.next=function(){var a=this.dive();this.backtrack();return a};a.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var a=j(this._path),b=a.node;a=a.keys;if(j(a)===h)return{done:!1,value:this.result()};this._path.push({node:b[j(a)],keys:Object.keys(b[j(a)])});return this.dive()};a.prototype.backtrack=function(){if(this._path.length===0)return;j(this._path).keys.pop();if(j(this._path).keys.length>0)return;this._path.pop();this.backtrack()};a.prototype.key=function(){return this.set._prefix+this._path.map(function(a){a=a.keys;return j(a)}).filter(function(a){return a!==h}).join("")};a.prototype.value=function(){return j(this._path).node[h]};a.prototype.result=function(){if(this._type===g)return this.value();return this._type===f?this.key():[this.key(),this.value()]};a.prototype[Symbol.iterator]=function(){return this};return a}(),j=function(a){return a[a.length-1]},k=0,l=1,m=2,n=3,o=function(a,b,d){var e=[{distance:0,i:0,key:"",node:a}],f={},g=[];a=function(){var a=e.pop(),i=a.node,j=a.distance,k=a.key,l=a.i,m=a.edit;Object.keys(i).forEach(function(n){if(n===h){var o=j+(b.length-l),a=c(f[k]||[null,Infinity],2);a=a[1];o<=d&&o<a&&(f[k]=[i[n],o])}else p(b,n,d-j,l,m,g).forEach(function(a){var c=a.distance,b=a.i;a=a.edit;e.push({node:i[n],distance:j+c,key:k+n,i:b,edit:a})})})};while(e.length>0)a();return f},p=function(a,b,c,d,e,f){f.push({distance:0,ia:d,ib:0,edit:e});d=[];while(f.length>0){e=f.pop();var g=e.distance,h=e.ia,i=e.ib;e=e.edit;if(i===b.length){d.push({distance:g,i:h,edit:e});continue}if(a[h]===b[i])f.push({distance:g,ia:h+1,ib:i+1,edit:k});else{if(g>=c)continue;e!==m&&f.push({distance:g+1,ia:h,ib:i+1,edit:n});h<a.length&&(e!==n&&f.push({distance:g+1,ia:h+1,ib:i,edit:m}),e!==n&&e!==m&&f.push({distance:g+1,ia:h+1,ib:i+1,edit:l}))}}return d},q=function(){function a(a,b){a===void 0&&(a={}),b===void 0&&(b=""),this._tree=a,this._prefix=b}a.prototype.atPrefix=function(d){var b;if(!d.startsWith(this._prefix))throw new Error("Mismatched prefix");var e=c(r(this._tree,d.slice(this._prefix.length)),2),f=e[0];e=e[1];if(f===void 0){e=c(y(e),2);var g=e[0],i=e[1];e=Object.keys(g).find(function(a){return a!==h&&a.startsWith(i)});if(e!==void 0)return new a((b={},b[e.slice(i.length)]=g[e],b),d)}return new a(f||{},d)};a.prototype.clear=function(){delete this._size,this._tree={}};a.prototype["delete"]=function(a){delete this._size;return v(this._tree,a)};a.prototype.entries=function(){return new i(this,e)};a.prototype.forEach=function(d){var e,a;try{for(var f=b(this),g=f.next();!g.done;g=f.next()){var h=c(g.value,2),i=h[0];h=h[1];d(i,h,this)}}catch(a){e={error:a}}finally{try{g&&!g.done&&(a=f["return"])&&a.call(f)}finally{if(e)throw e.error}}};a.prototype.fuzzyGet=function(a,b){return o(this._tree,a,b)};a.prototype.get=function(a){a=s(this._tree,a);return a!==void 0?a[h]:void 0};a.prototype.has=function(a){a=s(this._tree,a);return a!==void 0&&a.hasOwnProperty(h)};a.prototype.keys=function(){return new i(this,f)};a.prototype.set=function(a,b){if(typeof a!=="string")throw new Error("key must be a string");delete this._size;a=t(this._tree,a);a[h]=b;return this};Object.defineProperty(a.prototype,"size",{get:function(){var a=this;if(this._size)return this._size;this._size=0;this.forEach(function(){a._size+=1});return this._size},enumerable:!1,configurable:!0});a.prototype.update=function(a,b){if(typeof a!=="string")throw new Error("key must be a string");delete this._size;a=t(this._tree,a);a[h]=b(a[h]);return this};a.prototype.values=function(){return new i(this,g)};a.prototype[Symbol.iterator]=function(){return this.entries()};a.from=function(e){var f,d,g=new a();try{for(var h=b(e),i=h.next();!i.done;i=h.next()){e=c(i.value,2);var j=e[0];e=e[1];g.set(j,e)}}catch(a){f={error:a}}finally{try{i&&!i.done&&(d=h["return"])&&d.call(h)}finally{if(f)throw f.error}}return g};a.fromObject=function(b){return a.from(Object.entries(b))};return a}(),r=function(a,b,c){c===void 0&&(c=[]);if(b.length===0||a==null)return[a,c];var d=Object.keys(a).find(function(a){return a!==h&&b.startsWith(a)});if(d===void 0){c.push([a,b]);return r(void 0,"",c)}c.push([a,d]);return r(a[d],b.slice(d.length),c)},s=function(a,b){if(b.length===0||a==null)return a;var c=Object.keys(a).find(function(a){return a!==h&&b.startsWith(a)});return c===void 0?void 0:s(a[c],b.slice(c.length))},t=function(b,c){var a;if(c.length===0||b==null)return b;var d=Object.keys(b).find(function(a){return a!==h&&c.startsWith(a)});if(d===void 0){var e=Object.keys(b).find(function(a){return a!==h&&a.startsWith(c[0])});if(e===void 0)b[c]={};else{var f=u(c,e);b[f]=(a={},a[e.slice(f.length)]=b[e],a);delete b[e];return t(b[f],c.slice(f.length))}return b[c]}return t(b[d],c.slice(d.length))},u=function(a,b,c,d,e){c===void 0&&(c=0);d===void 0&&(d=Math.min(a.length,b.length));e===void 0&&(e="");if(c>=d)return e;return a[c]!==b[c]?e:u(a,b,c+1,d,e+a[c])},v=function(a,b){a=c(r(a,b),2);b=a[0];a=a[1];if(b===void 0)return;delete b[h];var d=Object.keys(b);d.length===0&&w(a);d.length===1&&x(a,d[0],b[d[0]])},w=function(b){if(b.length===0)return;var a=c(y(b),2),d=a[0];a=a[1];delete d[a];Object.keys(d).length===0&&w(b.slice(0,-1))},x=function(a,b,d){if(a.length===0)return;a=c(y(a),2);var e=a[0];a=a[1];e[a+b]=d;delete e[a]},y=function(a){return a[a.length-1]},z,A="or",B="and",C=function(){function b(b){if((b===null||b===void 0?void 0:b.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');this._options=a(a(a({},J),b),{searchOptions:a(a({},K),b.searchOptions||{})});this._index=new q();this._documentCount=0;this._documentIds={};this._fieldIds={};this._fieldLength={};this._averageFieldLength={};this._nextId=0;this._storedFields={};this.addFields(this._options.fields)}b.prototype.add=function(b){var c=this,a=this._options,d=a.extractField,e=a.tokenize,f=a.processTerm,g=a.fields;a=a.idField;var h=d(b,a);if(h==null)throw new Error('MiniSearch: document does not have ID field "'+a+'"');var i=this.addDocumentId(h);this.saveStoredFields(i,b);g.forEach(function(a){var g=d(b,a);if(g==null)return;g=e(g.toString(),a);c.addFieldLength(i,c._fieldIds[a],c.documentCount-1,g.length);g.forEach(function(b){b=f(b,a);b&&c.addTerm(c._fieldIds[a],i,b)})})};b.prototype.addAll=function(a){var b=this;a.forEach(function(a){return b.add(a)})};b.prototype.addAllAsync=function(a,b){var c=this;b===void 0&&(b={});b=b.chunkSize;var d=b===void 0?10:b;b={chunk:[],promise:Promise.resolve()};a=a.reduce(function(a,e,f){var b=a.chunk;a=a.promise;b.push(e);if((f+1)%d===0)return{chunk:[],promise:a.then(function(){return new Promise(function(a){return setTimeout(a,0)})}).then(function(){return c.addAll(b)})};else return{chunk:b,promise:a}},b);var e=a.chunk;b=a.promise;return b.then(function(){return c.addAll(e)})};b.prototype.remove=function(b){var d=this,a=this._options,e=a.tokenize,f=a.processTerm,g=a.extractField,h=a.fields;a=a.idField;var i=g(b,a);if(i==null)throw new Error('MiniSearch: document does not have ID field "'+a+'"');a=c(Object.entries(this._documentIds).find(function(a){a=c(a,2);a[0];a=a[1];return i===a})||[],1);var j=a[0];if(j==null)throw new Error("MiniSearch: cannot remove document with ID "+i+": it is not in the index");h.forEach(function(a){var c=g(b,a);if(c==null)return;c=e(c.toString(),a);c.forEach(function(b){b=f(b,a);b&&d.removeTerm(d._fieldIds[a],j,b)})});delete this._storedFields[j];delete this._documentIds[j];this._documentCount-=1};b.prototype.removeAll=function(a){var b=this;if(a)a.forEach(function(a){return b.remove(a)});else if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");else this._index=new q(),this._documentCount=0,this._documentIds={},this._fieldLength={},this._averageFieldLength={},this._storedFields={},this._nextId=0};b.prototype.search=function(d,e){var f=this;e===void 0&&(e={});var b=this._options,g=b.tokenize,h=b.processTerm;b=b.searchOptions;var i=a(a({tokenize:g,processTerm:h},b),e);g=i.tokenize;var j=i.processTerm;h=g(d).map(function(a){return j(a)}).filter(function(a){return!!a});b=h.map(H(i));e=b.map(function(a){return f.executeQuery(a,i)});g=this.combineResults(e,i.combineWith);return Object.entries(g).reduce(function(d,a){a=c(a,2);var e=a[0];a=a[1];var b=a.score,g=a.match;a=a.terms;a={id:f._documentIds[e],terms:I(a),score:b,match:g};Object.assign(a,f._storedFields[e]);(i.filter==null||i.filter(a))&&d.push(a);return d},[]).sort(function(a,b){a=a.score;b=b.score;return a<b?1:-1})};b.prototype.autoSuggest=function(b,d){d===void 0&&(d={});d=a(a({},L),d);b=this.search(b,d).reduce(function(c,a){var b=a.score;a=a.terms;var d=a.join(" ");c[d]==null?c[d]={score:b,terms:a,count:1}:(c[d].score+=b,c[d].count+=1);return c},{});return Object.entries(b).map(function(a){a=c(a,2);var d=a[0];a=a[1];var b=a.score,e=a.terms;a=a.count;return{suggestion:d,terms:e,score:b/a}}).sort(function(a,b){a=a.score;b=b.score;return a<b?1:-1})};Object.defineProperty(b.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0});b.loadJSON=function(a,c){if(c==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return b.loadJS(JSON.parse(a),c)};b.getDefault=function(a){if(J.hasOwnProperty(a))return D(J,a);else throw new Error('MiniSearch: unknown option "'+a+'"')};b.loadJS=function(a,c){var d=a.index,e=a.documentCount,f=a.nextId,g=a.documentIds,h=a.fieldIds,i=a.fieldLength,j=a.averageFieldLength;a=a.storedFields;c=new b(c);c._index=new q(d._tree,d._prefix);c._documentCount=e;c._nextId=f;c._documentIds=g;c._fieldIds=h;c._fieldLength=i;c._averageFieldLength=j;c._fieldIds=h;c._storedFields=a||{};return c};b.prototype.executeQuery=function(b,d){var e=this;d=a(a({},this._options.searchOptions),d);var f=(d.fields||this._options.fields).reduce(function(c,d){var b;return a(a({},c),(b={},b[d]=D(c,d)||1,b))},d.boost||{}),g=d.boostDocument;d=d.weights;d=a(a({},K.weights),d);var h=d.fuzzy,i=d.prefix;d=this.termResults(b.term,f,g,this._index.get(b.term));if(!b.fuzzy&&!b.prefix)return d;var j=[d];b.prefix&&this._index.atPrefix(b.term).forEach(function(a,c){var d=.3*(a.length-b.term.length)/a.length;j.push(e.termResults(a,f,g,c,i,d))});if(b.fuzzy){d=b.fuzzy===!0?.2:b.fuzzy;d=d<1?Math.round(b.term.length*d):d;Object.entries(this._index.fuzzyGet(b.term,d)).forEach(function(a){a=c(a,2);var b=a[0];a=c(a[1],2);var d=a[0];a=a[1];a=a/b.length;j.push(e.termResults(b,f,g,d,h,a))})}return j.reduce(E[A],{})};b.prototype.combineResults=function(a,b){b===void 0&&(b=A);if(a.length===0)return{};b=b.toLowerCase();return a.reduce(E[b],null)||{}};b.prototype.toJSON=function(){return{index:this._index,documentCount:this._documentCount,nextId:this._nextId,documentIds:this._documentIds,fieldIds:this._fieldIds,fieldLength:this._fieldLength,averageFieldLength:this._averageFieldLength,storedFields:this._storedFields}};b.prototype.termResults=function(a,b,d,e,f,g){var h=this;g===void 0&&(g=0);return e==null?{}:Object.entries(b).reduce(function(f,b){b=c(b,2);var i=b[0],j=b[1],k=h._fieldIds[i];b=e[k]||{ds:{}};var l=b.df;b=b.ds;Object.entries(b).forEach(function(b){b=c(b,2);var e=b[0];b=b[1];var m=d?d(h._documentIds[e],a):1;if(!m)return;var n=h._fieldLength[e][k]/h._averageFieldLength[k];f[e]=f[e]||{score:0,match:{},terms:[]};f[e].terms.push(a);f[e].match[a]=D(f[e].match,a)||[];f[e].score+=m*G(b,l,h._documentCount,n,j,g);f[e].match[a].push(i)});return f},{})};b.prototype.addTerm=function(b,c,d){this._index.update(d,function(d){d=d||{};var e=d[b]||{df:0,ds:{}};e.ds[c]==null&&(e.df+=1);e.ds[c]=(e.ds[c]||0)+1;return a(a({},d),(d={},d[b]=e,d))})};b.prototype.removeTerm=function(b,c,d){var e=this;if(!this._index.has(d)){this.warnDocumentChanged(c,b,d);return}this._index.update(d,function(f){var g=f[b];if(g==null||g.ds[c]==null){e.warnDocumentChanged(c,b,d);return f}if(g.ds[c]<=1){if(g.df<=1){delete f[b];return f}g.df-=1}if(g.ds[c]<=1){delete g.ds[c];return f}g.ds[c]-=1;return a(a({},f),(f={},f[b]=g,f))});Object.keys(this._index.get(d)).length===0&&this._index["delete"](d)};b.prototype.warnDocumentChanged=function(a,b,d){if(console==null||emptyFunction==null)return;a=Object.entries(this._fieldIds).find(function(a){a=c(a,2);a[0];a=a[1];return a===b})[0]};b.prototype.addDocumentId=function(a){var b=this._nextId.toString(36);this._documentIds[b]=a;this._documentCount+=1;this._nextId+=1;return b};b.prototype.addFields=function(a){var b=this;a.forEach(function(a,c){b._fieldIds[a]=c})};b.prototype.addFieldLength=function(a,b,c,d){this._averageFieldLength[b]=this._averageFieldLength[b]||0;var e=this._averageFieldLength[b]*c+d;this._fieldLength[a]=this._fieldLength[a]||{};this._fieldLength[a][b]=d;this._averageFieldLength[b]=e/(c+1)};b.prototype.saveStoredFields=function(b,c){var d=this,a=this._options,e=a.storeFields,f=a.extractField;if(e==null||e.length===0)return;this._storedFields[b]=this._storedFields[b]||{};e.forEach(function(a){var e=f(c,a);if(e===void 0)return;d._storedFields[b][a]=e})};return b}(),D=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)?a[b]:void 0},E=(z={},z[A]=function(a,b){return Object.entries(b).reduce(function(e,a){a=c(a,2);var f=a[0];a=a[1];var b=a.score,g=a.match;a=a.terms;e[f]==null?e[f]={score:b,match:g,terms:a}:(e[f].score+=b,e[f].score*=1.5,(b=e[f].terms).push.apply(b,d(a)),Object.assign(e[f].match,g));return e},a||{})},z[B]=function(b,e){return b==null?e:Object.entries(e).reduce(function(g,e){e=c(e,2);var h=e[0];e=e[1];var f=e.score,i=e.match;e=e.terms;if(b[h]===void 0)return g;g[h]=g[h]||{};g[h].score=b[h].score+f;g[h].match=a(a({},b[h].match),i);g[h].terms=d(b[h].terms,e);return g},{})},z),F=function(a,b,c){return a*Math.log(c/b)},G=function(a,b,c,d,e,f){e=e/(1+.333*e*f);return e*F(a,b,c)/d},H=function(a){return function(b,c,d){var e=typeof a.fuzzy==="function"?a.fuzzy(b,c,d):a.fuzzy||!1;c=typeof a.prefix==="function"?a.prefix(b,c,d):a.prefix===!0;return{term:b,fuzzy:e,prefix:c}}},I=function(a){return a.filter(function(b,c,a){return a.indexOf(b)===c})},J={idField:"id",extractField:function(a,b){return a[b]},tokenize:function(a,b){return a.split(M)},processTerm:function(a,b){return a.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},K={combineWith:A,prefix:!1,fuzzy:!1,boost:{},weights:{fuzzy:.9,prefix:.75}},L={prefix:function(a,b,c){return b===c.length-1}},M=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;return C})}var k=!1;function l(){k||(k=!0,j());return h.exports}function a(a){switch(a){case void 0:return l()}}e.exports=a}),null);
__d("minisearch",["minisearch-3.0.2"],(function(a,b,c,d,e,f){e.exports=b("minisearch-3.0.2")()}),null);
__d("MWPSearchOfflineOpenConversations",["minisearch"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("minisearch"))({fields:["content"],searchOptions:{fuzzy:.2,prefix:!0},storeFields:["category"]});function a(a){return h.search(a)}function b(a){h.add(a)}function d(a){h.remove(a)}g.search=a;g.add=b;g.remove=d}),98);
__d("MWPSearchOfflineOpenConversations.bs",["LSContactBitOffset.bs","LSContactCapabilityBitOffset.bs","LSDatabaseType.bs","LSInitSyncCompleteSubscription.bs","MNetRankType.bs","MWChatTemporarySearchResult.bs","MWInboxSecureContentSearch.bs","MWPSearchOfflineOpenConversations","Promise","ReQL.bs","ReStore.bs","bs_belt_Array","bs_belt_Option","bs_belt_SortArray","bs_caml","bs_caml_array","bs_caml_format","bs_caml_int64","bs_caml_option","bs_int64"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return"p__"+b("bs_int64").to_string(a)+"__"+b("bs_int64").to_string(c)}function g(a){a=a.split("__");var c=a.length;if(c!==3)return;else return[b("bs_caml_format").caml_int64_of_string(b("bs_caml_array").get(a,1)),b("bs_caml_format").caml_int64_of_string(b("bs_caml_array").get(a,2))]}function h(a,c){var d;return b("Promise").all([(d=b("ReQL.bs")).firstExn(d.map(d.fromTableAscending(a.table("_user_info")),function(a){return a.facebookUserId})),d.first(d.getKeyRange(d.fromTableAscending(a.table("threads")),{hd:b("bs_caml_format").caml_int64_of_string(c),tl:0}))]).then(function(c){var d=c[1];if(d!==void 0){var e=c[0];return b("Promise").all([b("MWInboxSecureContentSearch.bs").getThreadPics(d,e,a),b("MWInboxSecureContentSearch.bs").getThreadParticipants(d,a)]).then(function(a){var c=a[0];return b("MWChatTemporarySearchResult.bs").fromThread(d,"offline",e,c[0],c[1],a[1])})}else return b("Promise").resolve(void 0)})}function i(a,c){return b("Promise").all(c.map(function(c){var d=c.category;switch(d){case 0:d=c.id;d=g(d);if(d!==void 0)return h(a,b("bs_int64").to_string(d[0]));else return b("Promise").resolve(void 0);case 1:return h(a,c.id);case 2:var e=c.id;return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:b("bs_caml_format").caml_int64_of_string(e),tl:0})).then(function(c){if(c!==void 0&&!(c.isMemorialized||b("bs_caml").i64_eq(c.contactViewerRelationship,b("bs_caml_int64").one)||b("bs_caml").i64_neq(c.blockedByViewerStatus,b("bs_caml_int64").zero)||b("bs_belt_Option").getWithDefault(b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").restrictPlaced,c),!1)))return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("ranking_scores")),{hd:b("bs_caml_format").caml_int64_of_string(e),tl:{hd:b("MNetRankType.bs").messengerUserSearch,tl:0}})).then(function(a){return b("MWChatTemporarySearchResult.bs").fromContact(b("bs_caml_option").some(a),c,void 0,"offline")});else return b("Promise").resolve(void 0)})}})).then(function(a){return b("bs_belt_SortArray").stableSortByU(b("bs_belt_Array").keepMap(a,function(a){return a}),function(a,b){a=a.rankingScore;a=a!==void 0?a.score:0;b=b.rankingScore;b=b!==void 0?b.score:0;if(b>a)return 1;else if(b<a)return-1;else return 0})})}var j={contents:void 0};function c(a){var c=j.contents;if(c===void 0)return b("Promise").resolve([]);var d=b("bs_caml_option").valFromOption(c),e=b("MWPSearchOfflineOpenConversations").search(a).map(function(a){return a});return b("LSInitSyncCompleteSubscription.bs").maybeWaitForSyncGroup(d,b("LSDatabaseType.bs").ranking).then(function(a){return i(d,e)})}function k(a,c,d){return b("LSInitSyncCompleteSubscription.bs").maybeWaitForSyncGroup(a,b("LSDatabaseType.bs").ranking).then(function(e){var f=b("ReStore.bs").toGenericStorage(a);return b("Promise").all(c.map(function(a){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(f.table("ranking_scores")),{hd:b("bs_caml_format").caml_int64_of_string(a),tl:{hd:d,tl:0}})).then(function(b){if(b!==void 0)return[a,b.score]})}))})}function d(a,c){return k(a,c,b("MNetRankType.bs").messengerUserSearch)}f.getGroupParticipantKey=a;f.parseGroupParticipantKey=g;f.searchHelper=i;f.db=j;f.search=c;f.fetchRankingScoresHelper=k;f.fetchRankingScoresKP=d}),null);
__d("MWPSearchOpenIndexer.bs",["MWPSearchOfflineOpenConversations","MWPSearchOfflineOpenConversations.bs","ReQL.bs","ReQLSuspense","bs_caml_option","bs_int64"],(function(a,b,c,d,e,f){"use strict";var g=new Map();function h(a){var c=b("bs_int64").to_string(a.id);a=a.name;a={content:a,id:c,category:2};b("MWPSearchOfflineOpenConversations").add(a);g.set(c,a)}function i(a){var c=g.get(a);if(!(c==null)){g["delete"](a);b("MWPSearchOfflineOpenConversations").remove(c);return}}var j={contactRecords:g,addToIndex:h,remove:i},k=new Map();function l(a){var c=a.threadName;if(c===void 0)return;a=b("bs_int64").to_string(a.threadKey);c={content:c,id:a,category:1};b("MWPSearchOfflineOpenConversations").add(c);k.set(a,c)}function m(a){var c=k.get(a);if(!(c==null)){k["delete"](a);b("MWPSearchOfflineOpenConversations").remove(c);return}}var n={threadRecords:k,addToIndex:l,remove:m},o=new Map();function p(a,c){if(c===void 0)return;a=b("MWPSearchOfflineOpenConversations.bs").getGroupParticipantKey(a.threadKey,a.contactId);c=c.name;c={content:c,id:a,category:0};b("MWPSearchOfflineOpenConversations").add(c);o.set(a,c)}function q(a,c){a=b("ReQLSuspense").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:c.contactId,tl:0}));return p(c,a)}function r(a,c){a=b("MWPSearchOfflineOpenConversations.bs").getGroupParticipantKey(a,c);c=o.get(a);if(!(c==null)){o["delete"](a);b("MWPSearchOfflineOpenConversations").remove(c);return}}var s={participantRecords:o,addToIndex:p,addToIndexWithoutContact:q,remove:r};function a(a,c){if(typeof c==="number")return i(b("bs_int64").to_string(a));if(c.TAG===0)return h(c._0);a=c._0;i(b("bs_int64").to_string(a.id));return h(a)}function c(a,c){if(typeof c==="number")return m(b("bs_int64").to_string(a));if(c.TAG===0)return l(c._0);a=c._0;m(b("bs_int64").to_string(a.threadKey));return l(a)}function d(a,b,c,d){if(typeof d==="number")return r(b,c);if(d.TAG===0)return q(a,d._0);r(b,c);return q(a,d._0)}function e(a,c,d,e){b("MWPSearchOfflineOpenConversations.bs").db.contents=b("bs_caml_option").some(a),c.forEach(h),d.forEach(l),e.forEach(function(a){return p(a[0],a[1])})}f.Contacts=j;f.GroupThreads=n;f.GroupParticipants=s;f.onContactChanged=a;f.onGroupThreadChanged=c;f.onGroupParticipantChanged=d;f.startInitialIndex=e}),null);
__d("MWPSearchSystem.bs",["JSScheduler","MWChatSearchInsertRankingContacts.bs","MWLSUseSyncRankings.bs","MWPSearchIndexingSource.bs","Promise","bs_caml_option","bs_curry","cr:2753","cr:3072","promiseDone","qex","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g={contents:!1},h={contents:!1};c=b("qex")._("84");var i=c==null?!1:c,j=b("cr:2753")==null?void 0:b("bs_caml_option").some(b("cr:2753")),k=b("cr:3072")==null?void 0:b("bs_caml_option").some(b("cr:3072"));function a(a){if(!h.contents){h.contents=!0;b("JSScheduler").scheduleSpeculativeCallback(function(){b("MWChatSearchInsertRankingContacts.bs").insertRankingContacts(a);b("MWLSUseSyncRankings.bs").sync(a);if(k!==void 0||j!==void 0)if(!g.contents){g.contents=!0;b("promiseDone")(b("Promise").all([b("MWPSearchIndexingSource.bs").fetchContacts(a),i?b("MWPSearchIndexingSource.bs").fetchGroupThreads(a):b("Promise").resolve([]),i?b("MWPSearchIndexingSource.bs").fetchGroupParticipants(a):b("Promise").resolve([])]).then(function(c){var d=c[0];b("cr:3072")==null||b("bs_curry")._4(b("cr:3072").startInitialIndex,a,d,c[1],c[2]);if(!(b("cr:2753")==null))return b("bs_curry")._2(b("cr:2753").startInitialIndex,a,d)}),void 0,function(a){b("recoverableViolation")("Error indexing contacts for search","messenger_search",{error:b("bs_caml_option").some(a)})});b("MWPSearchIndexingSource.bs").subToContacts(a,function(a,c){b("cr:2753")==null||b("bs_curry")._2(b("cr:2753").onContactChanged,a,c);if(!(b("cr:3072")==null))return b("bs_curry")._2(b("cr:3072").onContactChanged,a,c)});if(i){b("MWPSearchIndexingSource.bs").subToGroupThreads(a,function(a,c){if(!(b("cr:3072")==null))return b("bs_curry")._2(b("cr:3072").onGroupThreadChanged,a,c)});b("MWPSearchIndexingSource.bs").subToGroupParticipants(a,function(c,d,e){if(!(b("cr:3072")==null))return b("bs_curry")._4(b("cr:3072").onGroupParticipantChanged,a,c,d,e)});return}else return}else return});return}}f.initialIndexingStarted=g;f.makeAllStarted=h;f.$MWPSearchOpenIndexer$requireCond=b("cr:3072");f.$MWPSearchSecureIndexer$OR$null$requireCondXplat=b("cr:2753");f.makeAll=a}),null);
__d("MWPSearchSystem.re",["MWPSearchSystem.bs"],(function(a,b,c,d,e,f){a=b("MWPSearchSystem.bs").makeAll;f.makeAll=a}),null);
__d("useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork",["react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useState;function a(a){var b=a.dataSource;a=i(!1);var c=a[0],d=a[1];a=h(function(a){a=a.requestParams;b.fetchNetwork(a,d)},[b]);return[{isLoading:c},a]}g["default"]=a}),98);
__d("useBaseTypeaheadSubscriptionDataSourceFetchResolver",["cometTypeaheadODSLogFetchNetworkEvent","cr:2557","react","recoverableViolation","useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork","useDebouncedComet"],(function(a,b,c,d,e,f,g){"use strict";e=d("react");var h=e.useCallback,i=e.useEffect,j=e.useRef;function a(a,d){var e=a.dataSource,f=a.dataSourceFetchConfigParams;f=f===void 0?{}:f;var g=f.requestFlow;f=f.shouldDebounceNetwork;var k=f===void 0?!0:f,l=a.onResolvePayload;f=c("useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork")({dataSource:e});a=f[0].isLoading;var m=f[1],n=c("useDebouncedComet")(m),o=h(function(a,b){var d=b.isTraceComplete;b=b.source;try{l(a,{isTraceComplete:d,source:b})}catch(a){c("recoverableViolation")("Failed to resolve fetched payload","search")}return b},[l]),p=j(g);i(function(){function a(a){a=a.requestParams;var b=a.requestFlow;b!=null&&(p.current=b);b={requestParams:babelHelpers["extends"]({},a,{requestFlow:p.current})};Boolean(k)?n(b):m(b)}d!=null&&a(d)},[m,n,d,k]);i(function(){var a=e.subscribe(function(a){o(a,{isTraceComplete:!0,source:a.entries.length>0?"network":"network-no-results"}),c("cometTypeaheadODSLogFetchNetworkEvent")&&c("cometTypeaheadODSLogFetchNetworkEvent")("comet.ta.fetch",!0,1),b("cr:2557")&&b("cr:2557")(["all"],a)});return a},[e,o]);return[{isLoading:a}]}g["default"]=a}),98);
__d("useBaseTypeaheadSubscriptionDataSourceFetch",["react","recoverableViolation","useBaseTypeaheadSubscriptionDataSourceFetchResolver"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useEffect,j=b.useState;function a(a){var b=j(null),d=b[0],e=b[1];b=c("useBaseTypeaheadSubscriptionDataSourceFetchResolver")(a,d);b=b[0].isLoading;var f=h(function(a,b){b===void 0&&(b="all"),e({requestParams:a,source:b})},[]),g=h(function(a){a=a||{};var b=a.requestFlow;a=a.source;if(d==null){c("recoverableViolation")("Refetch cannot be called with undefined `fetchParams`","search");return}var e=d.requestParams,g=e.loggingEventTrace;e=babelHelpers.objectWithoutPropertiesLoose(e,["loggingEventTrace"]);g=babelHelpers["extends"]({loggingEventTrace:babelHelpers["extends"]({},g,{sequenceID:String(Date.now())}),requestFlow:b},e);f(g,a)},[f,d]),k=a.dataSource;i(function(){return function(){k.unsubscribe()}},[k]);return[{isLoading:b,source:(a=d==null?void 0:d.source)!=null?a:"all"},f,g]}g["default"]=a}),98);
__d("CometInternalTypeaheadSubscriptionProvider",["CometInternalTypeaheadFetchContext","react","useBaseTypeaheadSubscriptionDataSourceFetch","useCometInternalTypeaheadStateDispatcher","useCometTypeaheadVolumeLoggingProvider"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useMemo;function a(a){var b=a.children,d=a.dataSource,e=a.dataSourceFetchConfigParams,f=a.loggingContext,g=a.onFetchEntries_DO_NOT_USE,k=a.traceProvider;a=c("useCometInternalTypeaheadStateDispatcher")();var l=a.dispatchActiveEntries,m=c("useCometTypeaheadVolumeLoggingProvider")(f);a=c("useBaseTypeaheadSubscriptionDataSourceFetch")({dataSource:d,dataSourceFetchConfigParams:e,onResolvePayload:i(function(a,b){var c;a=a.entries;var d=b.isTraceComplete;b=b.source;l((c=a)!=null?c:[]);m.logRequest(o);g&&g(a);k&&!k.isResolved()&&(d&&(b==="cache"&&a.length>=k.getEntriesCountForVisualComplete()?k.setEndReason("max_suggestions_reached"):b==="network"?k.setEndReason("all_queries_completed"):b==="network-no-results"&&k.setEndReason("all_queries_completed_no_network_results"),k.resolve()))},[l,g,k])});f=a[0];var n=f.isLoading,o=f.source,p=a[1],q=a[2];d=j(function(){return{fetch:p,isLoading:n,refetch:q,source:o}},[p,n,q,o]);return h.jsx(c("CometInternalTypeaheadFetchContext").Provider,{value:d,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("BaseSubscriptionTypeahead.react",["CometHeroInteractionContextPassthrough.react","CometInternalTypeahead.react","CometInternalTypeaheadStateProvider","CometInternalTypeaheadSubscriptionProvider","emptyFunction","react","useCometUniqueID","withCometTypeaheadInputStrategyShouldQueryStringFollowHighlightedEntry"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useMemo;function a(a){var b=a.autoFocus;b=b===void 0?!1:b;var d=a.isDisabled;d=d===void 0?!1:d;var e=a.errorMessage;e=e===void 0?null:e;var f=a.inputStrategyRenderer,g=a.dataSource,k=a.dataSourceFetchConfigParams,l=a.decorators,m=l===void 0?[]:l;l=a.emptyEntries_DO_NOT_USE;var n=a.id,o=a.label;o=o===void 0?"":o;var p=a.loggingContext,q=a.onBackspace;q=q===void 0?c("emptyFunction"):q;var r=a.onBlur;r=r===void 0?c("emptyFunction"):r;var s=a.onChange,t=a.onClose,u=a.onEnter;u=u===void 0?c("emptyFunction"):u;var v=a.onEscape;v=v===void 0?c("emptyFunction"):v;var w=a.onFetchEntries_DO_NOT_USE,x=a.onFocus;x=x===void 0?c("emptyFunction"):x;var y=a.onOpen,z=a.onPressEntry,A=a.placeholder;A=A===void 0?"":A;var B=a.shouldQueryStringFollowHighlightedEntry,C=B===void 0?!0:B;B=a.shouldQueryStringUpdateFromSelectedEntryOnClick;var D=B===void 0?!0:B;B=a.testid;B=B===void 0?"":B;B=a.traceProvider;var E=a.inputRef,F=a.viewRole;F=F===void 0?"listbox":F;var G=a.viewStrategyRenderer;a=babelHelpers.objectWithoutPropertiesLoose(a,["autoFocus","isDisabled","errorMessage","inputStrategyRenderer","dataSource","dataSourceFetchConfigParams","decorators","emptyEntries_DO_NOT_USE","id","label","loggingContext","onBackspace","onBlur","onChange","onClose","onEnter","onEscape","onFetchEntries_DO_NOT_USE","onFocus","onOpen","onPressEntry","placeholder","shouldQueryStringFollowHighlightedEntry","shouldQueryStringUpdateFromSelectedEntryOnClick","testid","traceProvider","inputRef","viewRole","viewStrategyRenderer"]);var H=c("useCometUniqueID")(),I=j(function(){var a=c("CometInternalTypeahead.react");m.forEach(function(b){var c=b.decorate;b=b.params;a=c(a,b)});return a},[m]),J=i(function(a){D&&s(a.label),z&&z(a)},[s,z,D]),K=j(function(){return c("withCometTypeaheadInputStrategyShouldQueryStringFollowHighlightedEntry")(f,{shouldQueryStringFollowHighlightedEntry:C})},[f,C]);o=o||A;return h.jsx(c("CometHeroInteractionContextPassthrough.react"),{clear:!0,children:h.jsx(c("CometInternalTypeaheadStateProvider"),{emptyEntries_DO_NOT_USE:l,onClose:t,onOpen:y,children:h.jsx(c("CometInternalTypeaheadSubscriptionProvider"),{dataSource:g,dataSourceFetchConfigParams:k,loggingContext:p,onFetchEntries_DO_NOT_USE:w,traceProvider:B,children:h.jsx(I,babelHelpers["extends"]({},a,{autoFocus:b,errorMessage:e,id:(l=n)!=null?l:H,inputRef:E,inputStrategyRenderer:K,isDisabled:d,label:o,onBackspace:q,onBlur:r,onChange:s,onDownArrow:c("emptyFunction"),onEnter:u,onEscape:v,onFocus:x,onHighlightEntry:c("emptyFunction"),onPressEntry:J,onShiftTab:c("emptyFunction"),onTab:c("emptyFunction"),onUpArrow:c("emptyFunction"),placeholder:A,testid:void 0,viewRole:F,viewStrategyRenderer:G}))})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LsUniversalSearchQueryChangedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("94");c=b("FalcoLoggerInternal").create("ls_universal_search_query_changed",a);e.exports=c}),null);
__d("LsUniversalSearchStartFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("96");c=b("FalcoLoggerInternal").create("ls_universal_search_start",a);e.exports=c}),null);